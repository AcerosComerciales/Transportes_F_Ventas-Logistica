Imports System
Imports System.Data
Imports System.Data.Common
Imports System.Collections.Generic

Imports ACFramework
Imports DAConexion
Imports ACETransporte

Partial Public Class DTRAN_VehiculosMantenimiento

#Region " Variables "
   'Public Shared Tabla As String = "TRAN_VehiculosMantenimiento"
   'Public Shared Esquema As String = "Transportes"

   'Public ReadOnly Property Tabla() As String
   '   Get
   '      Return "TRAN_VehiculosMantenimiento"
   '   End Get
   'End Property

   'Public ReadOnly Property Esquema() As String
   '   Get
   '      Return "Transportes"
   '   End Get
   'End Property

#End Region

#Region " Constructores "
	
#End Region

#Region " Procedimientos Almacenados "
   'Public Function VMANSS_Todos(ByRef listETRAN_VehiculosMantenimiento As List(Of ETRAN_VehiculosMantenimiento), ByVal x_join As List(Of ACJoin), ByVal x_where As Hashtable) As Boolean
   '   Try
   '      DAEnterprise.AsignarProcedure(getSelectAll(x_join, x_where), CommandType.Text)
   '      Using reader As DbDataReader = DAEnterprise.ExecuteDataReader()
   '         If reader.HasRows Then
   '            Dim _utilitarios As New ACEsquemas(New ETRAN_VehiculosMantenimiento())
   '            While reader.Read()
   '               Dim e_tran_vehiculosmantenimiento As New ETRAN_VehiculosMantenimiento()
   '               _utilitarios.ACCargarEsquemas(reader, e_tran_vehiculosmantenimiento)
   '               e_tran_vehiculosmantenimiento.Instanciar(ACEInstancia.Consulta)
   '               listETRAN_VehiculosMantenimiento.Add(e_tran_vehiculosmantenimiento)
   '            End While
   '            Return True
   '         Else
   '            Return False
   '         End If
   '      End Using
   '   Catch ex As Exception
   '      Throw ex
   '   End Try
   'End Function


#Region "Procedimientos Adicionales "
   'Public Function getSelectAll(ByVal x_join As List(Of ACJoin), ByVal x_where As Hashtable) As String
   '   Dim sql As String = ""
   '   Try
   '      Dim _join As New ACGenerador(Of ETRAN_VehiculosMantenimiento)
   '      sql &= _join.getJoin(Esquema, Tabla, x_join, x_where)
   '      Return sql
   '   Catch ex As Exception
   '      Throw ex
   '   End Try
   'End Function
#End Region
#End Region

#Region " Metodos "
   ''' <summary> 
   ''' Capa de Datos: TRAN_VMAN_ObtenerMantenimientos
   ''' </summary>
   ''' <param name="x_fecini">Parametro 1: </param> 
   ''' <param name="x_fecfin">Parametro 2: </param> 
   ''' <param name="x_opcion">Parametro 3: </param> 
   ''' <param name="x_cadena">Parametro 4: </param> 
   ''' <param name="x_todos">Parametro 5: </param> 
   ''' <returns></returns> 
   ''' <remarks></remarks> 
   Public Function TRAN_VMAN_ObtenerMantenimientos(ByVal m_listtran_vehiculosmantenimiento As List(Of ETRAN_VehiculosMantenimiento), ByVal x_fecini As Date, ByVal x_fecfin As Date, ByVal x_opcion As Short, ByVal x_cadena As String, ByVal x_todos As Boolean) As Boolean
      Try
         DAEnterprise.AsignarProcedure("TRAN_VMAN_ObtenerMantenimientos")
         DAEnterprise.AgregarParametro("@FecIni", x_fecini, DbType.DateTime, 8)
         DAEnterprise.AgregarParametro("@FecFin", x_fecfin, DbType.DateTime, 8)
         DAEnterprise.AgregarParametro("@Opcion", x_opcion, DbType.Int16, 2)
         DAEnterprise.AgregarParametro("@Cadena", x_cadena, DbType.String, 50)
         DAEnterprise.AgregarParametro("@Todos", x_todos, DbType.Boolean, 1)
         Using reader As DbDataReader = DAEnterprise.ExecuteDataReader()
            If reader.HasRows Then
               While reader.Read()
                  Dim _tran_vehiculosmantenimiento As New ETRAN_VehiculosMantenimiento()
                  ACEsquemas.ACCargarEsquema(reader, _tran_vehiculosmantenimiento)
                  _tran_vehiculosmantenimiento.Instanciar(ACEInstancia.Consulta)
                  m_listtran_vehiculosmantenimiento.Add(_tran_vehiculosmantenimiento)
               End While
               Return True
            Else
               Return False
            End If
         End Using
         Return True
      Catch ex As Exception
         Throw ex
      End Try
   End Function

   ''' <summary> 
   ''' Capa de Datos: TRAN_ObtenerDocCompraXMantenimiento
   ''' </summary>
   ''' <param name="x_vehic_id">Parametro 1: </param> 
   ''' <param name="x_vman_item">Parametro 2: </param> 
   ''' <returns></returns> 
   ''' <remarks></remarks> 
   Public Function TRAN_ObtenerDocCompraXMantenimiento(ByRef m_listtran_documentos As List(Of ETRAN_Documentos), ByVal x_vehic_id As Long, ByVal x_vman_item As Long) As Boolean
      Try
         DAEnterprise.AsignarProcedure("TRAN_ObtenerDocCompraXMantenimiento")
         DAEnterprise.AgregarParametro("@VEHIC_Id", x_vehic_id, DbType.Int64, 8)
         DAEnterprise.AgregarParametro("@VMAN_Item", x_vman_item, DbType.Int64, 8)
         Using reader As DbDataReader = DAEnterprise.ExecuteDataReader()
            If reader.HasRows Then
               While reader.Read()
                  Dim _tran_documentos As New ETRAN_Documentos()
                  ACEsquemas.ACCargarEsquema(reader, _tran_documentos)
                  _tran_documentos.Instanciar(ACEInstancia.Consulta)
                  m_listtran_documentos.Add(_tran_documentos)
               End While
               Return True
            Else
               Return False
            End If
         End Using
         Return True
      Catch ex As Exception
         Throw ex
      End Try
   End Function

#End Region


End Class

