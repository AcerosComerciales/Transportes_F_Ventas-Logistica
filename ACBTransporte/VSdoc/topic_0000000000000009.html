<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="GENERATOR" content="VSdocman - documentation generator; http://www.helixoft.com" />
	<title>BTRAN_CombustibleConsumo.Guardar (String, Boolean, String) (Método)</title>

	<link rel="stylesheet" type="text/css" href="msdn10_lightweight/msdn10_lightweight.css"></link>
	<script src="msdn10_lightweight/msdn10_lightweight.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shCore_helixoft.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushVb.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushCSharp.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushCpp.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushJScript.js" type="text/javascript"></script>
	<link href="SyntaxHighlighter/styles/shCore.css" rel="stylesheet" type="text/css" />
	<link href="SyntaxHighlighter/styles/shThemeMsdnLW.css" rel="stylesheet" type="text/css" />
	<script type="text/javascript">
		SyntaxHighlighter.all();
	</script>				

	<script type="text/javascript">
<!--
if (self.name != "vbdocright") {
	if (location.search != "?toc=no") {
		var filename = location.pathname.replace(/\\/g, "/");
		filename = filename.substring(filename.lastIndexOf('/')+1);
		location.replace("index.html#" + filename);
	} 
}

function replaceTitleAndUrl(win, title, url) {
	if(history.replaceState) {
		win.history.replaceState(null, title, url);
	} else {
		win.document.title = document.title;
		win.location.replace(url);
	}
}
//-->
	</script>	
</head>

<body style="direction: ltr;">
	<script type="text/javascript">
		try {
			if (location.search != "?toc=no") {
				parent.document.title = document.title;
				var filename = location.pathname.replace(/\\/g, "/");
				filename = filename.substring(filename.lastIndexOf('/')+1);
				if (window.parent.location.search == null || window.parent.location.search != "?" + filename) {
					if (window.parent.location.hash == null || window.parent.location.hash != "#" + filename) {
						replaceTitleAndUrl(window.parent, document.title, "index.html#" + filename);
					}
				}
			}
		} catch (ex) {}
	</script>
	<div id="topic">
<!--HEADER START-->
  <div id="header">
  	<div id="runningHeaderText">ACBTransporte Reference</div>
  	<h1 class="title">BTRAN_CombustibleConsumo.Guardar (String, Boolean, String) (Método)</h1>
  	<div id="headerLinks">

	<a href="#seeAlsoSection">Vea también</a>

		</div>
		<hr />
	</div>
<!--HEADER END-->
    
		<div id="mainSection">
      <div id="mainBody">
        <p />
       



        <br /><strong>Ensamblado:</strong> ACBTransporte (in ACBTransporte.dll)











<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Sintaxis</a></span>
		<div><hr /></div>
	</div>

	<div id="syntaxSection" class="section">	
	
	
	<div id="syntaxCodeBlocks">
		<div class="codeSnippetContainer">		
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCornerActive">
				</div>
				<div class="codeSnippetTab csFirstTab csActiveTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csLastTab csNaTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCorner">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeVB">
					<pre xml:space="preserve" class="brush: vb">Public Function Guardar( _&nbsp;<br />   ByVal <i>x_usuario</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>, _&nbsp;<br />   ByVal <i>x_documento</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">Boolean</a>, _&nbsp;<br />   ByVal <i>x_recib_codigo</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a> _&nbsp;<br />) As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">Boolean</a></pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>
		
		<div class="codeSnippetContainer">
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCorner">
				</div>
				<div class="codeSnippetTab csFirstTab csNaTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csActiveTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csLastTab csNaTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCorner">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeCsharp">
					<pre xml:space="preserve" class="brush: csharp">public <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">bool</a> Guardar(&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> <i>x_usuario</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">bool</a> <i>x_documento</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> <i>x_recib_codigo</i>&nbsp;<br />)</pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>

		<div class="codeSnippetContainer">
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCorner">
				</div>
				<div class="codeSnippetTab csFirstTab csNaTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csActiveTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csLastTab csNaTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCorner">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeCpp">
					<pre xml:space="preserve" class="brush: cpp">public: &nbsp;<br /><a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">bool</a> Guardar(&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>^ <i>x_usuario</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">bool</a> <i>x_documento</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>^ <i>x_recib_codigo</i>&nbsp;<br />) </pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>
		
		<div class="codeSnippetContainer">
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCorner">
				</div>
				<div class="codeSnippetTab csFirstTab csNaTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csActiveTab csLastTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCornerActive">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeJScript">
					<pre xml:space="preserve" class="brush: js">public function Guardar(&nbsp;<br />    <i>x_usuario</i> : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>,&nbsp;<br />    <i>x_documento</i> : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">boolean</a>,&nbsp;<br />    <i>x_recib_codigo</i> : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>&nbsp;<br />) : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">boolean</a>;</pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>
		
	</div>


<h4 class="subHeading">
	Parámetros</h4><dl paramName="x_usuario">
	<dt>
		<span class="parameter">
			x_usuario
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> 
		</p>
		<p>
			 
		</p>
	</dd>
</dl>
<dl paramName="x_documento">
	<dt>
		<span class="parameter">
			x_documento
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">bool</a> 
		</p>
		<p>
			 
		</p>
	</dd>
</dl>
<dl paramName="x_recib_codigo">
	<dt>
		<span class="parameter">
			x_recib_codigo
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> 
		</p>
		<p>
			 
		</p>
	</dd>
</dl>

<p />
<p />














	</div>
</div>





















<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Código fuente</a></span>
		<div><hr /></div>
	</div>

	<div id="sourceCodeSection" class="section">	
		<div class="codeSnippetContainer">		
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCornerActive">
				</div>
				<div class="codeSnippetTab csFirstTab csActiveTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csNaTab csLastTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCorner">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeVB">
					<pre xml:space="preserve" class="brush: vb">
Public Function Guardar(ByVal x_usuario As String, ByVal x_documento As Boolean, ByVal x_recib_codigo As String) As Boolean
    Dim m_btran_documentos As New BTRAN_Documentos()
    Try
       DAEnterprise.BeginTransaction()
       If m_tran_combustibleconsumo.Nuevo Then
          If x_documento Then
             m_btran_documentos.TRAN_Documentos = m_tran_combustibleconsumo.TRAN_Documentos
             m_btran_documentos.TRAN_Documentos.DOCUS_Codigo = String.Format(&quot;{0}{1}{2}&quot;, m_btran_documentos.TRAN_Documentos.TIPOS_CodTipoDocumento.Substring(3, 2) _
                                                                             , m_btran_documentos.TRAN_Documentos.DOCUS_Serie.Trim().PadLeft(3, &quot;0&quot;) _
                                                                             , m_btran_documentos.TRAN_Documentos.DOCUS_Numero.ToString().PadLeft(7, &quot;0&quot;))
             m_btran_documentos.TRAN_Documentos.ENTID_Codigo = m_tran_combustibleconsumo.ENTID_CodigoProveedor
             Dim _igv As Decimal = (ACETransporte.Constantes.Porcentaje_IGV) / 100
             m_btran_documentos.TRAN_Documentos.DOCUS_Importe = Math.Round(m_tran_combustibleconsumo.COMCO_Total / (_igv + 1), 2, MidpointRounding.AwayFromZero)
             m_btran_documentos.TRAN_Documentos.DOCUS_ImporteIGV = Math.Round((m_tran_combustibleconsumo.COMCO_Total / (_igv + 1)) * _igv, 2, MidpointRounding.AwayFromZero)
             m_btran_documentos.TRAN_Documentos.DOCUS_TotalPago = m_tran_combustibleconsumo.COMCO_Total
             m_btran_documentos.TRAN_Documentos.TIPOS_CodTipoMoneda = m_tran_combustibleconsumo.TIPOS_CodTipoMoneda
             m_btran_documentos.TRAN_Documentos.DOCUS_Fecha = m_tran_combustibleconsumo.COMCO_Fecha
             m_btran_documentos.crearDocumento(m_tran_combustibleconsumo.COMCO_Descripcion)
             m_btran_documentos.TRAN_Documentos.Instanciar(ACEInstancia.Nuevo)
 
             Dim _where As New Hashtable()
             _where.Add(&quot;DOCUS_Codigo&quot;, New ACWhere(m_btran_documentos.TRAN_Documentos.DOCUS_Codigo))
             _where.Add(&quot;ENTID_Codigo&quot;, New ACWhere(m_btran_documentos.TRAN_Documentos.ENTID_Codigo))
             If m_btran_documentos.CargarTodos(_where) Then
                Throw New Exception(String.Format(&quot;El Numero del documento {0}-{1}, ya existe para el proveedor: {2}{3}&quot; _
                                                  , m_btran_documentos.TRAN_Documentos.DOCUS_Serie, m_btran_documentos.TRAN_Documentos.DOCUS_Numero.ToString().PadLeft(7, &quot;0&quot;) _
                                                  , m_btran_documentos.TRAN_Documentos.ENTID_Codigo.Substring(1), vbNewLine))
             End If
 
             If m_btran_documentos.Guardar(x_usuario, True, False) Then
                m_tran_combustibleconsumo.DOCUS_Codigo = m_btran_documentos.TRAN_Documentos.DOCUS_Codigo
                m_tran_combustibleconsumo.ENTID_CodigoProveedor = m_btran_documentos.TRAN_Documentos.ENTID_Codigo
                m_tran_combustibleconsumo.ZONAS_Codigo = ACBVentas.BConstantes.ZONAS_Codigo
                m_tran_combustibleconsumo.SUCUR_Id = ACBVentas.BConstantes.SUCUR_Id
                m_tran_combustibleconsumo.COMCO_Estado = ETRAN_CombustibleConsumo.getEstado(ETRAN_CombustibleConsumo.Estado.Ingresado)
                If Guardar(x_usuario) Then
                   '' Pagos
                   Dim _caja As New BTESO_Caja
                   _caja.TESO_Caja = New ETESO_Caja
                   _caja.TESO_Caja.Instanciar(ACEInstancia.Nuevo)
                   Dim managerTRAN_Recibos As New BTRAN_Recibos
                   managerTRAN_Recibos.TRAN_Recibos = New ETRAN_Recibos
 
                   _caja.TESO_Caja.PVENT_Id = m_pvent_id
                   _caja.TESO_Caja.TIPOS_CodTipoMoneda = m_tran_combustibleconsumo.TIPOS_CodTipoMoneda
                   _caja.TESO_Caja.TIPOS_CodTipoDocumento = ETipos.getTipoComprobante(ETipos.TipoComprobanteVenta.GastosViaje)
                   Dim managerGenerarDocsVenta As New BGenerarDocsVenta(m_pvent_id, m_periodo, m_zonas_codigo, m_sucur_id)
 
                   If managerGenerarDocsVenta.GetSeries(m_aplicacion, m_zonas_codigo, m_sucur_id, m_pvent_id, ETipos.getTipoComprobante(ETipos.TipoComprobanteVenta.Caja)) Then
                      _caja.TESO_Caja.CAJA_Serie = managerGenerarDocsVenta.ListVENT_PVentDocumento(0).PVDOCU_Serie
                   End If
                   Dim managerGenerarCancelacion As New BGenerarCancelacion(m_pvent_id, m_periodo, m_zonas_codigo, m_sucur_id)
                   _caja.TESO_Caja.CAJA_Numero = managerGenerarCancelacion.getNroTransaccion(_caja.TESO_Caja.CAJA_Serie)
                   _caja.TESO_Caja.CAJA_OrdenDocumento = 1
                   _caja.TESO_Caja.CAJA_Fecha = m_tran_combustibleconsumo.COMCO_FechaViaje
                   _caja.TESO_Caja.CAJA_Importe = m_tran_combustibleconsumo.COMCO_Total
                   _caja.TESO_Caja.CAJA_Glosa = String.Format(&quot;Registro de Consumo de Combustible del Viaje Nro: {0}&quot;, m_tran_combustibleconsumo.VIAJE_Id)
                   _caja.TESO_Caja.CAJA_Pase = ACEVentas.Constantes.GetPase(ACEVentas.Constantes.Pase.Gasto)
                   _caja.TESO_Caja.CAJA_Estado = ETESO_Caja.getEstado(ETESO_Caja.Estado.Ingresado)
                   _caja.TESO_Caja.ENTID_Codigo = m_btran_documentos.TRAN_Documentos.ENTID_Codigo
                   _caja.TESO_Caja.TIPOS_CodTipoOrigen = ETipos.getTipoOrigen(ETipos.OrigenCancelacion.CGViajes)
 
                   Dim _serie As String = &quot;001&quot; : Dim _numero As Integer
                   If managerTRAN_Recibos.GetSeries(m_zonas_codigo, m_sucur_id, 0, ETipos.getTipoComprobante(ETipos.TipoComprobanteVenta.ReciboTransporte)) Then
                      _serie = managerTRAN_Recibos.ListVENT_PVentDocumento(0).PVDOCU_Serie
                      _numero = managerTRAN_Recibos.getNumero(_serie, ETipos.getTipo(ETipos.TipoRecibo.ConDocumento)) + 1
                   End If
                   managerTRAN_Recibos.TRAN_Recibos.RECIB_Codigo = String.Format(&quot;{0}{1}{2:0000000}&quot;, ETipos.getTipo(ETipos.TipoRecibo.ConDocumento).Substring(3, 1).PadLeft(2, &quot;0&quot;) _
                                                                               , _serie, _numero)
                   _caja.TESO_Caja.CAJA_NroDocumento = managerTRAN_Recibos.TRAN_Recibos.RECIB_Codigo
                   _caja.TESO_Caja.CAJA_Codigo = String.Format(&quot;{0:00}{1}{2:0000000}&quot;, m_pvent_id, _caja.TESO_Caja.CAJA_Serie, _caja.TESO_Caja.CAJA_Numero)
                   Dim _whereCaja As New Hashtable : _whereCaja.Add(&quot;PVENT_Id&quot;, New ACWhere(_caja.TESO_Caja.PVENT_Id))
                   _caja.TESO_Caja.CAJA_Id = _caja.getCorrelativo(&quot;CAJA_Id&quot;, _whereCaja)
 
                   If _caja.Guardar(x_usuario, New String() {&quot;CAJA_Hora&quot;, &quot;CAJA_FechaPago&quot;}) Then
                      managerTRAN_Recibos.TRAN_Recibos.Instanciar(ACEInstancia.Nuevo)
                      managerTRAN_Recibos.TRAN_Recibos.RECIB_Concepto = _caja.TESO_Caja.CAJA_Glosa
                      managerTRAN_Recibos.TRAN_Recibos.RECIB_Serie = _serie
                      managerTRAN_Recibos.TRAN_Recibos.VIAJE_Id = m_tran_combustibleconsumo.VIAJE_Id
                      managerTRAN_Recibos.TRAN_Recibos.RECIB_Numero = _numero
                      managerTRAN_Recibos.TRAN_Recibos.ZONAS_Codigo = m_zonas_codigo
                      managerTRAN_Recibos.TRAN_Recibos.SUCUR_Id = m_sucur_id
                      managerTRAN_Recibos.TRAN_Recibos.TIPOS_CodTipoMoneda = _caja.TESO_Caja.TIPOS_CodTipoMoneda
                      managerTRAN_Recibos.TRAN_Recibos.TIPOS_CodTipoRecibo = ETipos.getTipo(ETipos.TipoRecibo.ConDocumento)
                      managerTRAN_Recibos.TRAN_Recibos.RECIB_Fecha = _caja.TESO_Caja.CAJA_Fecha
                      managerTRAN_Recibos.TRAN_Recibos.RECIB_Monto = _caja.TESO_Caja.CAJA_Importe
                      managerTRAN_Recibos.TRAN_Recibos.RECIB_CodReferencia = m_tran_combustibleconsumo.COMCO_Id
                      managerTRAN_Recibos.TRAN_Recibos.RECIB_CodRecRef = x_recib_codigo
                      If managerTRAN_Recibos.Guardar(x_usuario) Then
                         DAEnterprise.CommitTransaction()
                         Return True
                      Else
                         Throw New Exception(&quot;No se puede Guardar los recibos&quot;)
                      End If
                   End If
                End If
             End If
          Else
             m_tran_combustibleconsumo.ZONAS_Codigo = ACBVentas.BConstantes.ZONAS_Codigo
             m_tran_combustibleconsumo.SUCUR_Id = ACBVentas.BConstantes.SUCUR_Id
             m_tran_combustibleconsumo.COMCO_Estado = ETRAN_CombustibleConsumo.getEstado(ETRAN_CombustibleConsumo.Estado.Ingresado)
             If Guardar(x_usuario) Then
                DAEnterprise.CommitTransaction()
                Return True
             End If
          End If
       ElseIf m_tran_combustibleconsumo.Modificado Then
          If Guardar(x_usuario) Then
             m_btran_documentos.TRAN_Documentos = m_tran_combustibleconsumo.TRAN_Documentos
             m_btran_documentos.TRAN_Documentos.DOCUS_TotalPago = m_tran_combustibleconsumo.COMCO_Total
             Dim _igv As Decimal = (ACETransporte.Constantes.Porcentaje_IGV) / 100
             m_btran_documentos.TRAN_Documentos.DOCUS_Importe = Math.Round(m_tran_combustibleconsumo.COMCO_Total / (_igv + 1), 2, MidpointRounding.AwayFromZero)
             m_btran_documentos.TRAN_Documentos.DOCUS_ImporteIGV = Math.Round((m_tran_combustibleconsumo.COMCO_Total / (_igv + 1)) * _igv, 2, MidpointRounding.AwayFromZero)
             m_btran_documentos.TRAN_Documentos.TIPOS_CodTipoMoneda = m_tran_combustibleconsumo.TIPOS_CodTipoMoneda
             m_btran_documentos.TRAN_Documentos.DOCUS_Fecha = m_tran_combustibleconsumo.COMCO_Fecha
 
             If m_btran_documentos.Guardar(x_usuario) Then
                Dim _btran_recibos As New BTRAN_Recibos
                _btran_recibos.TRAN_Recibos = New ETRAN_Recibos
                _btran_recibos.TRAN_Recibos.Instanciar(ACEInstancia.Modificado)
                _btran_recibos.TRAN_Recibos.RECIB_Codigo = m_tran_combustibleconsumo.RECIB_Codigo
                _btran_recibos.TRAN_Recibos.RECIB_Fecha = m_tran_combustibleconsumo.COMCO_FechaViaje
                If _btran_recibos.Guardar(x_usuario) Then
                   Dim _bteso_caja As New BTESO_Caja
                   _bteso_caja.TESO_Caja = New ETESO_Caja
                   _bteso_caja.TESO_Caja.Instanciar(ACEInstancia.Modificado)
                   _bteso_caja.TESO_Caja.CAJA_Id = m_tran_combustibleconsumo.CAJA_Id
                   _bteso_caja.TESO_Caja.PVENT_Id = m_pvent_id
                   _bteso_caja.TESO_Caja.CAJA_Fecha = m_tran_combustibleconsumo.COMCO_FechaViaje
                   _bteso_caja.TESO_Caja.CAJA_Importe = m_tran_combustibleconsumo.COMCO_Total
 
                   If _bteso_caja.Guardar(x_usuario) Then
                      DAEnterprise.CommitTransaction()
                      Return True
                   End If
                End If
             End If
          End If
       Else
          Return True
       End If
       DAEnterprise.RollBackTransaction()
       Return False
    Catch ex As Exception
       DAEnterprise.RollBackTransaction()
       Throw ex
    End Try
 End Function
					</pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>

	</div>					
</div>



<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Plataformas</a></span>
		<div><hr /></div>
	</div>

	<div id="platformsSection" class="section">	
		<p>
			Windows 8, Windows Server 2012, Windows 7, Windows Vista SP1 or later, Windows XP SP3, Windows XP SP2 x64 Edition, Windows Server 2008 (Server Core not supported), Windows Server 2008 R2 (Server Core supported with SP1 or later), Windows Server 2003 SP2
		</p>
		<p>
			.NET Framework no admite todas las versiones de cada plataforma. Para obtener una lista de las versiones admitidas, vea 
			<a target="_top" href="http://msdn2.microsoft.com/en-us/library/298275e2-da1d-4618-9f74-6a3567832350.aspx">System Requirements</a>.
		</p>
	</div>					
</div>



  

	

	
	

<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Información de versión</a></span>
		<div><hr /></div>
	</div>

	<div id="frameworksSection" class="section">	
  <h4 class="subHeading">.NET Framework</h4>Supported in: 4.5, 4, 3.5, 3.0, 2.0, 1.1, 1.0<br />

	<h4 class="subHeading">.NET Compact Framework</h4>Supported in: 3.5, 2.0, 1.0<br />

	<h4 class="subHeading">XNA Framework</h4>Supported in: 3.0, 2.0, 1.0<br />
	
	</div>					
</div>

<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Vea también</a></span>
		<div><hr /></div>
	</div>

	<div id="seeAlsoSection" class="section">	
		<div>
			<h4 class="subHeading">
				Referencia</h4>
			<a href="topic_0000000000000000.html">BTRAN_CombustibleConsumo (Clase)</a><br />
<a href="topic_0000000000000000_members--.html">BTRAN_CombustibleConsumo (Miembros)</a><br />




			

		</div>
	</div>					
</div>
			</div>
			</div>
      <div id="footer">
      	<p><span style="color: #FF0000;">Generated with unregistered version of <a target="_top" href="http://www.helixoft.com/vsdocman/overview.html">VSdocman</a></span>&nbsp;<br />Your own footer text will only be shown in registered version.</p>
      </div>
    </div>
  	<script type="text/javascript">
<!--
	try {
		parent.frames["vbdocswitch"].expandLinkInToc(location.href);
	} catch (ex) {}
//-->
		</script>	
  </body>
</html>

