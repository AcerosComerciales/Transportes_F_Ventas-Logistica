Imports System
Imports System.Data
Imports System.Collections.Generic

Imports ACELogistica
Imports ACDLogistica
Imports Microsoft.Practices.Unity
Imports Microsoft.Practices.Unity.Configuration
Imports System.Configuration
Imports ACFramework
Imports ACEVentas

Public Class BABAS_DocsCompra

#Region " Variables "

#End Region

#Region " Constructores "

#End Region

#Region " Propiedades "

#End Region

#Region " Funciones para obtencion de datos "

#End Region

#Region " Metodos "

   ''' <summary>
   ''' cargar la busqueda de documentos
   ''' </summary>
   ''' <param name="x_cadena">Cadena de busqueda</param>
   ''' <param name="x_campo">campo por el cual se realizara la busqueda</param>
   ''' <param name="x_todos">Opcion para cargar todos los registros ignorando el estado del documento</param>
   ''' <param name="x_fecini">Fecha inicial</param>
   ''' <param name="x_fecfin">Fecha final</param>
   ''' <returns></returns>
   ''' <remarks></remarks>
   Public Function Busqueda(ByVal x_cadena As String, ByVal x_campo As String, ByVal x_todos As Boolean, ByVal x_fecini As DateTime, ByVal x_fecfin As DateTime _
                            , ByVal x_pvent_id As Long) As Boolean
      Try
         Dim _join As New List(Of ACJoin)
         _join.Add(New ACJoin(EEntidades.Esquema, EEntidades.Tabla, "Ent", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("ENTID_Codigo", "ENTID_CodigoProveedor")} _
                            , New ACCampos() {New ACCampos("ENTID_RazonSocial", "ENTID_Proveedor")}))
         _join.Add(New ACJoin(EAlmacenes.Esquema, EAlmacenes.Tabla, "Alma", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("ALMAC_Id", "ALMAC_Id")} _
                            , New ACCampos() {New ACCampos("ALMAC_Descripcion", "ALMAC_Descripcion")}))
         _join.Add(New ACJoin(ETipos.Esquema, ETipos.Tabla, "TDoc", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("TIPOS_Codigo", "TIPOS_CodTipoDocumento")} _
                            , New ACCampos() {New ACCampos("TIPOS_DescCorta", "TIPOS_Documento")}))
         _join.Add(New ACJoin(ETipos.Esquema, ETipos.Tabla, "TMone", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("TIPOS_Codigo", "TIPOS_CodTipoMoneda")} _
                            , New ACCampos() {New ACCampos("TIPOS_Descripcion", "TIPOS_TipoMoneda")}))
         _join.Add(New ACJoin(ETipos.Esquema, ETipos.Tabla, "TPag", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("TIPOS_Codigo", "TIPOS_CodTipoPago")} _
                            , New ACCampos() {New ACCampos("TIPOS_Descripcion", "TIPOS_TipoPago")}))
         Dim _where As New Hashtable()
         If x_campo.Contains("ENTID") Then
            _where.Add(x_campo, New ACWhere(x_cadena, "Ent", "System.String", ACWhere.TipoWhere._Like))
         Else
            _where.Add(x_campo, New ACWhere(x_cadena, ACWhere.TipoWhere._Like))
         End If
         _where.Add("DOCCO_FechaDocumento", New ACWhere(x_fecini, x_fecfin, ACWhere.TipoWhere.Between))
         _where.Add("PVENT_Id", New ACWhere(x_pvent_id))
         _where.Add(ACWhere.OrderBy, New ACWhere(New ACOrderBy() {New ACOrderBy("DOCCO_Codigo", ACOrderBy.Ordenamiento.Ascendente)}))
         If Not x_todos Then
            _where.Add("DOCCO_Estado", New ACWhere(EABAS_IngresosCompra.getEstado(EABAS_IngresosCompra.Estado.Anulado), ACWhere.TipoWhere.Diferente))
         End If
         m_listABAS_DocsCompra = New List(Of EABAS_DocsCompra)
         Return d_abas_docscompra.ABAS_DOCCOSS_Todos(m_listABAS_DocsCompra, _join, _where)
      Catch ex As Exception
         Throw ex
      End Try
   End Function

   ''' <summary> 
   ''' Capa de Negocio: LOG_DOCCOSS_TodosDocCompra
   ''' </summary>
   ''' <param name="x_zonas_codigo">Parametro 1: </param> 
   ''' <param name="x_sucur_id">Parametro 2: </param> 
   ''' <param name="x_cadena">Parametro 3: </param> 
   ''' <param name="x_opcion">Parametro 4: </param> 
   ''' <param name="x_todos">Parametro 5: </param> 
   ''' <param name="x_fecini">Parametro 6: </param> 
   ''' <param name="x_fecfin">Parametro 7: </param> 
   ''' <returns></returns> 
   ''' <remarks></remarks> 
   Public Function Busqueda(ByVal x_zonas_codigo As String, ByVal x_sucur_id As Short, ByVal x_cadena As String, ByVal x_opcion As Short, ByVal x_todos As Boolean, ByVal x_fecini As Date, ByVal x_fecfin As Date) As Boolean
      m_listABAS_DocsCompra = New List(Of EABAS_DocsCompra)
      Try
         Return d_abas_docscompra.LOG_DOCCOSS_TodosDocCompra(m_listABAS_DocsCompra, x_zonas_codigo, x_sucur_id, x_cadena, x_opcion, x_todos, x_fecini, x_fecfin)
      Catch ex As Exception
         Throw ex
      End Try
   End Function

   'Public Function Busqueda(ByVal x_cadena As String, ByVal x_campo As String, ByVal x_todos As Boolean, ByVal x_fecini As DateTime _
   '                        , ByVal x_fecfin As DateTime) As Boolean
   '   Try
   '      Dim _join As New List(Of ACJoin)
   '      _join.Add(New ACJoin(EEntidades.Esquema, EEntidades.Tabla, "Ent", ACJoin.TipoJoin.Inner _
   '                         , New ACCampos() {New ACCampos("ENTID_Codigo", "ENTID_CodigoProveedor")} _
   '                         , New ACCampos() {New ACCampos("ENTID_RazonSocial", "ENTID_Proveedor")}))
   '      _join.Add(New ACJoin(EAlmacenes.Esquema, EAlmacenes.Tabla, "Alma", ACJoin.TipoJoin.Inner _
   '                         , New ACCampos() {New ACCampos("ALMAC_Id", "ALMAC_Id")} _
   '                         , New ACCampos() {New ACCampos("ALMAC_Descripcion", "ALMAC_Descripcion")}))
   '      _join.Add(New ACJoin(ETipos.Esquema, ETipos.Tabla, "TDoc", ACJoin.TipoJoin.Inner _
   '                         , New ACCampos() {New ACCampos("TIPOS_Codigo", "TIPOS_CodTipoDocumento")} _
   '                         , New ACCampos() {New ACCampos("TIPOS_DescCorta", "TIPOS_Documento")}))
   '      _join.Add(New ACJoin(ETipos.Esquema, ETipos.Tabla, "TMone", ACJoin.TipoJoin.Inner _
   '                         , New ACCampos() {New ACCampos("TIPOS_Codigo", "TIPOS_CodTipoMoneda")} _
   '                         , New ACCampos() {New ACCampos("TIPOS_Descripcion", "TIPOS_TipoMoneda")}))
   '      _join.Add(New ACJoin(ETipos.Esquema, ETipos.Tabla, "TPag", ACJoin.TipoJoin.Inner _
   '                         , New ACCampos() {New ACCampos("TIPOS_Codigo", "TIPOS_CodTipoPago")} _
   '                         , New ACCampos() {New ACCampos("TIPOS_Descripcion", "TIPOS_TipoPago")}))
   '      Dim _where As New Hashtable()
   '      If x_campo.Contains("ENTID") Then
   '         _where.Add(x_campo, New ACWhere(x_cadena, "Ent", "System.String", ACWhere.TipoWhere._Like))
   '      Else
   '         _where.Add(x_campo, New ACWhere(x_cadena, ACWhere.TipoWhere._Like))
   '      End If
   '      _where.Add("DOCCO_FechaDocumento", New ACWhere(x_fecini, x_fecfin, ACWhere.TipoWhere.Between))
   '      _where.Add(ACWhere.OrderBy, New ACWhere(New ACOrderBy() {New ACOrderBy("DOCCO_Codigo", ACOrderBy.Ordenamiento.Ascendente)}))
   '      If Not x_todos Then
   '         _where.Add("DOCCO_Estado", New ACWhere(EABAS_IngresosCompra.getEstado(EABAS_IngresosCompra.Estado.Anulado), ACWhere.TipoWhere.Diferente))
   '      End If
   '      m_listABAS_DocsCompra = New List(Of EABAS_DocsCompra)
   '      Return d_abas_docscompra.ABAS_DOCCOSS_Todos(m_listABAS_DocsCompra, _join, _where)
   '   Catch ex As Exception
   '      Throw ex
   '   End Try
   'End Function

   ''' <summary>
   ''' cargar la busqueda de documentos
   ''' </summary>
   ''' <param name="x_cadena">Cadena de busqueda</param>
   ''' <param name="x_campo">campo por el cual se realizara la busqueda</param>
   ''' <param name="x_todos">Opcion para cargar todos los registros ignorando el estado del documento</param>
   ''' <param name="x_fecini">Fecha inicial</param>
   ''' <param name="x_fecfin">Fecha final</param>
   ''' <param name="x_in">Para definir que estados se cargaran</param>
   ''' <returns></returns>
   ''' <remarks></remarks>
   Public Function Busqueda(ByVal x_cadena As String, ByVal x_campo As String, ByVal x_todos As Boolean _
                            , ByVal x_fecini As DateTime, ByVal x_fecfin As DateTime, ByVal x_in As String _
                            , ByVal x_pvent_id As Long) As Boolean
      Try
         Dim _join As New List(Of ACJoin)
         _join.Add(New ACJoin(EEntidades.Esquema, EEntidades.Tabla, "Ent", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("ENTID_Codigo", "ENTID_CodigoProveedor")} _
                            , New ACCampos() {New ACCampos("ENTID_RazonSocial", "ENTID_Proveedor")}))
         _join.Add(New ACJoin(EAlmacenes.Esquema, EAlmacenes.Tabla, "Alma", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("ALMAC_Id", "ALMAC_Id")} _
                            , New ACCampos() {New ACCampos("ALMAC_Descripcion", "ALMAC_Descripcion")}))
         _join.Add(New ACJoin(ETipos.Esquema, ETipos.Tabla, "TDoc", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("TIPOS_Codigo", "TIPOS_CodTipoDocumento")} _
                            , New ACCampos() {New ACCampos("TIPOS_DescCorta", "TIPOS_Documento")}))
         _join.Add(New ACJoin(ETipos.Esquema, ETipos.Tabla, "TMone", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("TIPOS_Codigo", "TIPOS_CodTipoMoneda")} _
                            , New ACCampos() {New ACCampos("TIPOS_Descripcion", "TIPOS_TipoMoneda")}))
         _join.Add(New ACJoin(ETipos.Esquema, ETipos.Tabla, "TPag", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("TIPOS_Codigo", "TIPOS_CodTipoPago")} _
                            , New ACCampos() {New ACCampos("TIPOS_Descripcion", "TIPOS_TipoPago")}))
         Dim _where As New Hashtable()
         If x_campo.Contains("ENTID") Then
            _where.Add(x_campo, New ACWhere(x_cadena, "Ent", "System.String", ACWhere.TipoWhere._Like))
         Else
            _where.Add(x_campo, New ACWhere(x_cadena, ACWhere.TipoWhere._Like))
         End If
         _where.Add("DOCCO_FechaDocumento", New ACWhere(x_fecini, x_fecfin, ACWhere.TipoWhere.Between))
         _where.Add("PVENT_Id", New ACWhere(x_pvent_id))
         _where.Add("TIPOS_CodTipoDocumento", New ACWhere(x_in, ACWhere.TipoWhere._In))
         _where.Add(ACWhere.OrderBy, New ACWhere(New ACOrderBy() {New ACOrderBy("DOCCO_Codigo", ACOrderBy.Ordenamiento.Ascendente)}))
         If Not x_todos Then
            _where.Add("DOCCO_Estado", New ACWhere(EABAS_IngresosCompra.getEstado(EABAS_IngresosCompra.Estado.Ingresado), ACWhere.TipoWhere.Igual))
         End If
         m_listABAS_DocsCompra = New List(Of EABAS_DocsCompra)
         Return d_abas_docscompra.ABAS_DOCCOSS_Todos(m_listABAS_DocsCompra, _join, _where)
      Catch ex As Exception
         Throw ex
      End Try
   End Function

   ''' <summary>
   ''' cargar la busqueda de documentos
   ''' </summary>
   ''' <param name="x_cadena">Cadena de busqueda</param>
   ''' <param name="x_campo">campo por el cual se realizara la busqueda</param>
   ''' <param name="x_todos">Opcion para cargar todos los registros ignorando el estado del documento</param>
   ''' <param name="x_fecini">Fecha inicial</param>
   ''' <param name="x_fecfin">Fecha final</param>
   ''' <param name="x_in">Para definir que estados se cargaran</param>
   ''' <returns></returns>
   ''' <remarks></remarks>
   Public Function Busqueda(ByVal x_cadena As String, ByVal x_campo As String, ByVal x_todos As Boolean _
                            , ByVal x_fecini As DateTime, ByVal x_fecfin As DateTime, ByVal x_in As String _
                            ) As Boolean
      Try
         Dim _join As New List(Of ACJoin)
         _join.Add(New ACJoin(EEntidades.Esquema, EEntidades.Tabla, "Ent", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("ENTID_Codigo", "ENTID_CodigoProveedor")} _
                            , New ACCampos() {New ACCampos("ENTID_RazonSocial", "ENTID_Proveedor")}))
         _join.Add(New ACJoin(EAlmacenes.Esquema, EAlmacenes.Tabla, "Alma", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("ALMAC_Id", "ALMAC_Id")} _
                            , New ACCampos() {New ACCampos("ALMAC_Descripcion", "ALMAC_Descripcion")}))
         _join.Add(New ACJoin(ETipos.Esquema, ETipos.Tabla, "TDoc", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("TIPOS_Codigo", "TIPOS_CodTipoDocumento")} _
                            , New ACCampos() {New ACCampos("TIPOS_DescCorta", "TIPOS_Documento")}))
         _join.Add(New ACJoin(ETipos.Esquema, ETipos.Tabla, "TMone", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("TIPOS_Codigo", "TIPOS_CodTipoMoneda")} _
                            , New ACCampos() {New ACCampos("TIPOS_Descripcion", "TIPOS_TipoMoneda")}))
         _join.Add(New ACJoin(ETipos.Esquema, ETipos.Tabla, "TPag", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("TIPOS_Codigo", "TIPOS_CodTipoPago")} _
                            , New ACCampos() {New ACCampos("TIPOS_Descripcion", "TIPOS_TipoPago")}))
         Dim _where As New Hashtable()
         If x_campo.Contains("ENTID") Then
            _where.Add(x_campo, New ACWhere(x_cadena, "Ent", "System.String", ACWhere.TipoWhere._Like))
         Else
            _where.Add(x_campo, New ACWhere(x_cadena, ACWhere.TipoWhere._Like))
         End If
         _where.Add("DOCCO_FechaDocumento", New ACWhere(x_fecini, x_fecfin, ACWhere.TipoWhere.Between))
         _where.Add("TIPOS_CodTipoDocumento", New ACWhere(x_in, ACWhere.TipoWhere._In))
         _where.Add(ACWhere.OrderBy, New ACWhere(New ACOrderBy() {New ACOrderBy("DOCCO_Codigo", ACOrderBy.Ordenamiento.Ascendente)}))
         If Not x_todos Then
            _where.Add("DOCCO_Estado", New ACWhere(EABAS_IngresosCompra.getEstado(EABAS_IngresosCompra.Estado.Ingresado), ACWhere.TipoWhere.Igual))
         End If
         m_listABAS_DocsCompra = New List(Of EABAS_DocsCompra)
         Return d_abas_docscompra.ABAS_DOCCOSS_Todos(m_listABAS_DocsCompra, _join, _where)
      Catch ex As Exception
         Throw ex
      End Try
   End Function

   ''' <summary>
   ''' cargar la busqueda de documentos por el numero de documento
   ''' </summary>
   ''' <param name="x_doc">Numero del documento</param>
   ''' <param name="x_serie">Serie del documento</param>
   ''' <param name="x_numero">Numero del documento</param>
   ''' <param name="x_todos">Opcion para cargar todos los registro ignorando el estado del documento</param>
   ''' <param name="x_fecini">Fecha inicial</param>
   ''' <param name="x_fecfin">Fecha Final</param>
   ''' <returns></returns>
   ''' <remarks></remarks>
   Public Function Busqueda(ByVal x_doc As String, ByVal x_serie As String, ByVal x_numero As String, ByVal x_todos As Boolean _
                            , ByVal x_fecini As DateTime, ByVal x_fecfin As DateTime _
                            , ByVal x_pvent_id As Long) As Boolean
      Try
         Dim _join As New List(Of ACJoin)
         _join.Add(New ACJoin(EEntidades.Esquema, EEntidades.Tabla, "Ent", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("ENTID_Codigo", "ENTID_CodigoProveedor")} _
                            , New ACCampos() {New ACCampos("ENTID_RazonSocial", "ENTID_Proveedor")}))
         _join.Add(New ACJoin(EAlmacenes.Esquema, EAlmacenes.Tabla, "Alma", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("ALMAC_Id", "ALMAC_Id")} _
                            , New ACCampos() {New ACCampos("ALMAC_Descripcion", "ALMAC_Descripcion")}))
         _join.Add(New ACJoin(ETipos.Esquema, ETipos.Tabla, "TDoc", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("TIPOS_Codigo", "TIPOS_CodTipoDocumento")} _
                            , New ACCampos() {New ACCampos("TIPOS_DescCorta", "TIPOS_Documento")}))
         _join.Add(New ACJoin(ETipos.Esquema, ETipos.Tabla, "TMone", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("TIPOS_Codigo", "TIPOS_CodTipoMoneda")} _
                            , New ACCampos() {New ACCampos("TIPOS_Descripcion", "TIPOS_TipoMoneda")}))
         _join.Add(New ACJoin(ETipos.Esquema, ETipos.Tabla, "TPag", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("TIPOS_Codigo", "TIPOS_CodTipoPago")} _
                            , New ACCampos() {New ACCampos("TIPOS_Descripcion", "TIPOS_TipoPago")}))
         Dim _where As New Hashtable()
         _where.Add("TIPOS_CodTipoDocumento", New ACWhere(x_doc, ACWhere.TipoWhere._Like))
         _where.Add("DOCCO_Serie", New ACWhere(x_serie, ACWhere.TipoWhere._Like))
         _where.Add("DOCCO_Numero", New ACWhere(x_numero, ACWhere.TipoWhere._Like))
         _where.Add("PVENT_Id", New ACWhere(x_pvent_id))
         '_where.Add("DOCCO_FechaDocumento", New ACWhere(x_fecini, x_fecfin, ACWhere.TipoWhere.Between))
         _where.Add(ACWhere.OrderBy, New ACWhere(New ACOrderBy() {New ACOrderBy("DOCCO_Codigo", ACOrderBy.Ordenamiento.Ascendente)}))
         If Not x_todos Then
            _where.Add("DOCCO_Estado", New ACWhere(EABAS_IngresosCompra.getEstado(EABAS_IngresosCompra.Estado.Ingresado), ACWhere.TipoWhere.Igual))
         End If
         m_listABAS_DocsCompra = New List(Of EABAS_DocsCompra)
         Return d_abas_docscompra.ABAS_DOCCOSS_Todos(m_listABAS_DocsCompra, _join, _where)
      Catch ex As Exception
         Throw ex
      End Try
   End Function

   Public Function Busqueda(ByVal x_doc As String, ByVal x_serie As String, ByVal x_numero As String, ByVal x_todos As Boolean _
                            , ByVal x_fecini As DateTime, ByVal x_fecfin As DateTime _
                            ) As Boolean
      Try
         Dim _join As New List(Of ACJoin)
         _join.Add(New ACJoin(EEntidades.Esquema, EEntidades.Tabla, "Ent", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("ENTID_Codigo", "ENTID_CodigoProveedor")} _
                            , New ACCampos() {New ACCampos("ENTID_RazonSocial", "ENTID_Proveedor")}))
         _join.Add(New ACJoin(EAlmacenes.Esquema, EAlmacenes.Tabla, "Alma", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("ALMAC_Id", "ALMAC_Id")} _
                            , New ACCampos() {New ACCampos("ALMAC_Descripcion", "ALMAC_Descripcion")}))
         _join.Add(New ACJoin(ETipos.Esquema, ETipos.Tabla, "TDoc", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("TIPOS_Codigo", "TIPOS_CodTipoDocumento")} _
                            , New ACCampos() {New ACCampos("TIPOS_DescCorta", "TIPOS_Documento")}))
         _join.Add(New ACJoin(ETipos.Esquema, ETipos.Tabla, "TMone", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("TIPOS_Codigo", "TIPOS_CodTipoMoneda")} _
                            , New ACCampos() {New ACCampos("TIPOS_Descripcion", "TIPOS_TipoMoneda")}))
         _join.Add(New ACJoin(ETipos.Esquema, ETipos.Tabla, "TPag", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("TIPOS_Codigo", "TIPOS_CodTipoPago")} _
                            , New ACCampos() {New ACCampos("TIPOS_Descripcion", "TIPOS_TipoPago")}))
         Dim _where As New Hashtable()
         _where.Add("TIPOS_CodTipoDocumento", New ACWhere(x_doc, ACWhere.TipoWhere._Like))
         _where.Add("DOCCO_Serie", New ACWhere(x_serie, ACWhere.TipoWhere._Like))
         _where.Add("DOCCO_Numero", New ACWhere(x_numero, ACWhere.TipoWhere._Like))
         _where.Add("DOCCO_FechaDocumento", New ACWhere(x_fecini, x_fecfin, ACWhere.TipoWhere.Between))
         _where.Add(ACWhere.OrderBy, New ACWhere(New ACOrderBy() {New ACOrderBy("DOCCO_Codigo", ACOrderBy.Ordenamiento.Ascendente)}))
         If Not x_todos Then
            _where.Add("DOCCO_Estado", New ACWhere(EABAS_IngresosCompra.getEstado(EABAS_IngresosCompra.Estado.Ingresado), ACWhere.TipoWhere.Igual))
         End If
         m_listABAS_DocsCompra = New List(Of EABAS_DocsCompra)
         Return d_abas_docscompra.ABAS_DOCCOSS_Todos(m_listABAS_DocsCompra, _join, _where)
      Catch ex As Exception
         Throw ex
      End Try
   End Function

   ''' <summary>
   ''' cargar la busqueda de documentos por el numero de documento
   ''' </summary>
   ''' <param name="x_doc">Numero del documento</param>
   ''' <param name="x_serie">Serie del documento</param>
   ''' <param name="x_numero">Numero del documento</param>
   ''' <param name="x_todos">Opcion para cargar todos los registro ignorando el estado del documento</param>
   ''' <param name="x_fecini">Fecha inicial</param>
   ''' <param name="x_fecfin">Fecha Final</param>
   ''' <param name="x_in">Opcion para definir que estados se tomaran en cuenta para la busqueda</param>
   ''' <returns></returns>
   ''' <remarks></remarks>
   Public Function Busqueda(ByVal x_doc As String, ByVal x_serie As String, ByVal x_numero As String, ByVal x_todos As Boolean _
                         , ByVal x_fecini As DateTime, ByVal x_fecfin As DateTime, ByVal x_in As String _
                         , ByVal x_pvent_id As Long) As Boolean
      Try
         Dim _join As New List(Of ACJoin)
         _join.Add(New ACJoin(EEntidades.Esquema, EEntidades.Tabla, "Ent", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("ENTID_Codigo", "ENTID_CodigoProveedor")} _
                            , New ACCampos() {New ACCampos("ENTID_RazonSocial", "ENTID_Proveedor")}))
         _join.Add(New ACJoin(EAlmacenes.Esquema, EAlmacenes.Tabla, "Alma", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("ALMAC_Id", "ALMAC_Id")} _
                            , New ACCampos() {New ACCampos("ALMAC_Descripcion", "ALMAC_Descripcion")}))
         _join.Add(New ACJoin(ETipos.Esquema, ETipos.Tabla, "TDoc", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("TIPOS_Codigo", "TIPOS_CodTipoDocumento")} _
                            , New ACCampos() {New ACCampos("TIPOS_DescCorta", "TIPOS_Documento")}))
         _join.Add(New ACJoin(ETipos.Esquema, ETipos.Tabla, "TMone", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("TIPOS_Codigo", "TIPOS_CodTipoMoneda")} _
                            , New ACCampos() {New ACCampos("TIPOS_Descripcion", "TIPOS_TipoMoneda")}))
         _join.Add(New ACJoin(ETipos.Esquema, ETipos.Tabla, "TPag", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("TIPOS_Codigo", "TIPOS_CodTipoPago")} _
                            , New ACCampos() {New ACCampos("TIPOS_Descripcion", "TIPOS_TipoPago")}))
         Dim _where As New Hashtable()
         _where.Add("TIPOS_CodTipoDocumento", New ACWhere(x_doc, ACWhere.TipoWhere._Like))
         _where.Add("DOCCO_Serie", New ACWhere(x_serie, ACWhere.TipoWhere._Like))
         _where.Add("DOCCO_Numero", New ACWhere(x_numero, ACWhere.TipoWhere._Like))
         _where.Add("DOCCO_FechaDocumento", New ACWhere(x_fecini, x_fecfin, ACWhere.TipoWhere.Between))
         _where.Add("PVENT_Id", New ACWhere(x_pvent_id))
         _where.Add("TIPOS_CodTipoDocumento", New ACWhere(x_in, ACWhere.TipoWhere._In))
         _where.Add(ACWhere.OrderBy, New ACWhere(New ACOrderBy() {New ACOrderBy("DOCCO_Codigo", ACOrderBy.Ordenamiento.Ascendente)}))
         If Not x_todos Then
            _where.Add("DOCCO_Estado", New ACWhere(EABAS_IngresosCompra.getEstado(EABAS_IngresosCompra.Estado.Ingresado), ACWhere.TipoWhere.Igual))
         End If
         m_listABAS_DocsCompra = New List(Of EABAS_DocsCompra)
         Return d_abas_docscompra.ABAS_DOCCOSS_Todos(m_listABAS_DocsCompra, _join, _where)
      Catch ex As Exception
         Throw ex
      End Try
   End Function

   Public Function Busqueda(ByVal x_doc As String, ByVal x_serie As String, ByVal x_numero As String, ByVal x_todos As Boolean _
                         , ByVal x_fecini As DateTime, ByVal x_fecfin As DateTime, ByVal x_in As String _
                         ) As Boolean
      Try
         Dim _join As New List(Of ACJoin)
         _join.Add(New ACJoin(EEntidades.Esquema, EEntidades.Tabla, "Ent", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("ENTID_Codigo", "ENTID_CodigoProveedor")} _
                            , New ACCampos() {New ACCampos("ENTID_RazonSocial", "ENTID_Proveedor")}))
         _join.Add(New ACJoin(EAlmacenes.Esquema, EAlmacenes.Tabla, "Alma", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("ALMAC_Id", "ALMAC_Id")} _
                            , New ACCampos() {New ACCampos("ALMAC_Descripcion", "ALMAC_Descripcion")}))
         _join.Add(New ACJoin(ETipos.Esquema, ETipos.Tabla, "TDoc", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("TIPOS_Codigo", "TIPOS_CodTipoDocumento")} _
                            , New ACCampos() {New ACCampos("TIPOS_DescCorta", "TIPOS_Documento")}))
         _join.Add(New ACJoin(ETipos.Esquema, ETipos.Tabla, "TMone", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("TIPOS_Codigo", "TIPOS_CodTipoMoneda")} _
                            , New ACCampos() {New ACCampos("TIPOS_Descripcion", "TIPOS_TipoMoneda")}))
         _join.Add(New ACJoin(ETipos.Esquema, ETipos.Tabla, "TPag", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("TIPOS_Codigo", "TIPOS_CodTipoPago")} _
                            , New ACCampos() {New ACCampos("TIPOS_Descripcion", "TIPOS_TipoPago")}))
         Dim _where As New Hashtable()
         _where.Add("TIPOS_CodTipoDocumento", New ACWhere(x_doc, ACWhere.TipoWhere._Like))
         _where.Add("DOCCO_Serie", New ACWhere(x_serie, ACWhere.TipoWhere._Like))
         _where.Add("DOCCO_Numero", New ACWhere(x_numero, ACWhere.TipoWhere._Like))
         _where.Add("DOCCO_FechaDocumento", New ACWhere(x_fecini, x_fecfin, ACWhere.TipoWhere.Between))
         _where.Add("TIPOS_CodTipoDocumento", New ACWhere(x_in, ACWhere.TipoWhere._In))
         _where.Add(ACWhere.OrderBy, New ACWhere(New ACOrderBy() {New ACOrderBy("DOCCO_Codigo", ACOrderBy.Ordenamiento.Ascendente)}))
         If Not x_todos Then
            _where.Add("DOCCO_Estado", New ACWhere(EABAS_IngresosCompra.getEstado(EABAS_IngresosCompra.Estado.Ingresado), ACWhere.TipoWhere.Igual))
         End If
         m_listABAS_DocsCompra = New List(Of EABAS_DocsCompra)
         Return d_abas_docscompra.ABAS_DOCCOSS_Todos(m_listABAS_DocsCompra, _join, _where)
      Catch ex As Exception
         Throw ex
      End Try
   End Function

   ''' <summary>
   ''' Cargar el documento de compra incluyendo su detalle
   ''' </summary>
   ''' <param name="x_entid_codigo">codigo de la entidad proveedor</param>
   ''' <param name="x_detalle">Opcion para cargar el detalle del documento de compra</param>
   ''' <returns></returns>
   ''' <remarks></remarks>
   Public Function Cargar(ByVal x_docco_codigo As String, ByVal x_entid_codigo As String, ByVal x_detalle As Boolean) As Boolean
      Try
         Dim _join As New List(Of ACJoin)
         _join.Add(New ACJoin(EEntidades.Esquema, EEntidades.Tabla, "Ent", ACJoin.TipoJoin.Inner _
                            , New ACCampos() {New ACCampos("ENTID_Codigo", "ENTID_CodigoProveedor")} _
                            , New ACCampos() {New ACCampos("ENTID_RazonSocial", "ENTID_Proveedor") _
                                            , New ACCampos("ENTID_Codigo", "ENTID_CodigoProveedor") _
                                            , New ACCampos("ENTID_NroDocumento", "ENTID_NroDocumento")}))
         Dim _where As New Hashtable()
         _where.Add("DOCCO_Codigo", New ACWhere(x_docco_codigo, ACWhere.TipoWhere.Igual))
         _where.Add("ENTID_CodigoProveedor", New ACWhere(x_entid_codigo, ACWhere.TipoWhere.Igual))
         If Cargar(_join, _where) Then
            If x_detalle Then
               Dim m_babas_docsompradetalle As New BABAS_DocsCompraDetalle
               Dim _joinDet As New List(Of ACJoin)
               _joinDet.Add(New ACJoin(EArticulos.Esquema, EArticulos.Tabla, "Art", ACJoin.TipoJoin.Inner _
                                  , New ACCampos() {New ACCampos("ARTIC_Codigo", "ARTIC_Codigo")} _
                                  , New ACCampos() {New ACCampos("ARTIC_Descripcion", "ARTIC_Descripcion") _
                                                    , New ACCampos("ARTIC_Id", "ARTIC_Id")}))
               _joinDet.Add(New ACJoin(ETipos.Esquema, ETipos.Tabla, "TDes", ACJoin.TipoJoin.Inner _
                                  , New ACCampos() {New ACCampos("TIPOS_Codigo", "TIPOS_CodTipoDestino")} _
                                  , New ACCampos() {New ACCampos("TIPOS_Descripcion", "TIPOS_TipoDestino")}))
               _joinDet.Add(New ACJoin(ETipos.Esquema, ETipos.Tabla, "TUni", "Art", ACJoin.TipoJoin.Inner _
                                  , New ACCampos() {New ACCampos("TIPOS_Codigo", "TIPOS_CodUnidadMedida")} _
                                  , New ACCampos() {New ACCampos("TIPOS_Descripcion", "TIPOS_UnidadMedida")}))
               Dim _whereDet As New Hashtable()
               _whereDet.Add("DOCCO_Codigo", New ACWhere(x_docco_codigo, ACWhere.TipoWhere.Igual))
               _whereDet.Add("ENTID_CodigoProveedor", New ACWhere(x_entid_codigo, ACWhere.TipoWhere.Igual))
               m_babas_docsompradetalle.CargarTodos(_joinDet, _whereDet)
               m_eabas_docscompra.ListEABAS_DocsCompraDetalle = New List(Of EABAS_DocsCompraDetalle)(m_babas_docsompradetalle.ListABAS_DocsCompraDetalle)
            End If
            Return True
         Else
            Return False
         End If
      Catch ex As Exception
         Throw ex
      End Try
   End Function

   ''' <summary> 
   ''' Capa de Negocio: COSTESS_ObtenerDocCosteados
   ''' </summary>
   ''' <param name="x_entid_codigoproveedor">Parametro 1: </param> 
   ''' <param name="x_docco_codigo">Parametro 2: </param> 
   ''' <param name="x_detalle">Parametro 3: </param> 
   ''' <returns></returns> 
   ''' <remarks></remarks> 
   Public Function ObtenerDocCosteados(ByVal x_entid_codigoproveedor As String, ByVal x_docco_codigo As String, ByVal x_detalle As Boolean) As Boolean
      m_eabas_docscompra = New EABAS_DocsCompra
      Try
         Return d_abas_docscompra.COSTESS_ObtenerDocCosteados(m_eabas_docscompra, x_entid_codigoproveedor, x_docco_codigo, x_detalle)
      Catch ex As Exception
         Throw ex
      End Try
   End Function



   Public Function CargarUltimos(ByVal x_artic_codigo As String) As Boolean
      Try

      Catch ex As Exception
         Throw ex
      End Try
   End Function

   ''' <summary> 
   ''' Capa de Negocio: LOG_ABASSS_ConsultaCompras
   ''' </summary>
   ''' <param name="x_cadena">Parametro 1: </param> 
   ''' <param name="x_opciontc">Parametro 2: </param> 
   ''' <param name="x_todos">Parametro 3: </param> 
   ''' <param name="x_fecini">Parametro 4: </param> 
   ''' <param name="x_fecfin">Parametro 5: </param> 
   ''' <returns></returns> 
   ''' <remarks></remarks> 
   Public Function ConsultaCompras(ByVal x_cadena As String, ByVal x_opciontc As Short, ByVal x_todos As Boolean, ByVal x_fecini As Date, ByVal x_fecfin As Date) As Boolean
      m_listABAS_DocsCompra = New List(Of EABAS_DocsCompra)
      Try
         Return d_abas_docscompra.LOG_ABASSS_ConsultaCompras(m_listABAS_DocsCompra, x_cadena, x_opciontc, x_todos, x_fecini, x_fecfin)
      Catch ex As Exception
         Throw ex
      End Try
   End Function
#End Region

End Class
