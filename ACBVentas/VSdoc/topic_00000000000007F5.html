<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="GENERATOR" content="VSdocman - documentation generator; http://www.helixoft.com" />
	<title>BAdminCaja.GrabarDeposito (Método)</title>

	<link rel="stylesheet" type="text/css" href="msdn10_lightweight/msdn10_lightweight.css"></link>
	<script src="msdn10_lightweight/msdn10_lightweight.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shCore_helixoft.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushVb.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushCSharp.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushCpp.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushJScript.js" type="text/javascript"></script>
	<link href="SyntaxHighlighter/styles/shCore.css" rel="stylesheet" type="text/css" />
	<link href="SyntaxHighlighter/styles/shThemeMsdnLW.css" rel="stylesheet" type="text/css" />
	<script type="text/javascript">
		SyntaxHighlighter.all();
	</script>				

	<script type="text/javascript">
<!--
if (self.name != "vbdocright") {
	if (location.search != "?toc=no") {
		var filename = location.pathname.replace(/\\/g, "/");
		filename = filename.substring(filename.lastIndexOf('/')+1);
		location.replace("index.html#" + filename);
	} 
}

function replaceTitleAndUrl(win, title, url) {
	if(history.replaceState) {
		win.history.replaceState(null, title, url);
	} else {
		win.document.title = document.title;
		win.location.replace(url);
	}
}
//-->
	</script>	
</head>

<body style="direction: ltr;">
	<script type="text/javascript">
		try {
			if (location.search != "?toc=no") {
				parent.document.title = document.title;
				var filename = location.pathname.replace(/\\/g, "/");
				filename = filename.substring(filename.lastIndexOf('/')+1);
				if (window.parent.location.search == null || window.parent.location.search != "?" + filename) {
					if (window.parent.location.hash == null || window.parent.location.hash != "#" + filename) {
						replaceTitleAndUrl(window.parent, document.title, "index.html#" + filename);
					}
				}
			}
		} catch (ex) {}
	</script>
	<div id="topic">
<!--HEADER START-->
  <div id="header">
  	<div id="runningHeaderText">ACBVentas Reference</div>
  	<h1 class="title">BAdminCaja.GrabarDeposito (Método)</h1>
  	<div id="headerLinks">

	<a href="#seeAlsoSection">Vea también</a>

		</div>
		<hr />
	</div>
<!--HEADER END-->
    
		<div id="mainSection">
      <div id="mainBody">
        <p />
       
        Grabar el deposito



        <br /><strong>Ensamblado:</strong> ACBVentas (in ACBVentas.dll)











<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Sintaxis</a></span>
		<div><hr /></div>
	</div>

	<div id="syntaxSection" class="section">	
	
	
	<div id="syntaxCodeBlocks">
		<div class="codeSnippetContainer">		
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCornerActive">
				</div>
				<div class="codeSnippetTab csFirstTab csActiveTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csLastTab csNaTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCorner">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeVB">
					<pre xml:space="preserve" class="brush: vb">Private Function GrabarDeposito( _&nbsp;<br />   ByVal <i>x_usuario</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>, _&nbsp;<br />   ByVal <i>x_entid_codigo</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>, _&nbsp;<br />   ByVal <i>x_caja_codigo</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>, _&nbsp;<br />   ByVal <i>x_saldoafavor</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">Boolean</a>, _&nbsp;<br />   ByVal <i>x_fecha</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.datetime.aspx">Date</a>, _&nbsp;<br />   ByVal <i>x_importe</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.decimal.aspx">Decimal</a>, _&nbsp;<br />   ByVal <i>x_tiporecibo</i> As <strong>ETipos</strong> _&nbsp;<br />) As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">Boolean</a></pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>
		
		<div class="codeSnippetContainer">
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCorner">
				</div>
				<div class="codeSnippetTab csFirstTab csNaTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csActiveTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csLastTab csNaTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCorner">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeCsharp">
					<pre xml:space="preserve" class="brush: csharp">private <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">bool</a> GrabarDeposito(&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> <i>x_usuario</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> <i>x_entid_codigo</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> <i>x_caja_codigo</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">bool</a> <i>x_saldoafavor</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.datetime.aspx">DateTime</a> <i>x_fecha</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.decimal.aspx">decimal</a> <i>x_importe</i>,&nbsp;<br />   <strong>ETipos</strong> <i>x_tiporecibo</i>&nbsp;<br />)</pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>

		<div class="codeSnippetContainer">
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCorner">
				</div>
				<div class="codeSnippetTab csFirstTab csNaTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csActiveTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csLastTab csNaTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCorner">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeCpp">
					<pre xml:space="preserve" class="brush: cpp">private: &nbsp;<br /><a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">bool</a> GrabarDeposito(&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>^ <i>x_usuario</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>^ <i>x_entid_codigo</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>^ <i>x_caja_codigo</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">bool</a> <i>x_saldoafavor</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.datetime.aspx">DateTime</a> <i>x_fecha</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.decimal.aspx">Decimal</a> <i>x_importe</i>,&nbsp;<br />   <strong>ETipos</strong>^ <i>x_tiporecibo</i>&nbsp;<br />) </pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>
		
		<div class="codeSnippetContainer">
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCorner">
				</div>
				<div class="codeSnippetTab csFirstTab csNaTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csActiveTab csLastTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCornerActive">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeJScript">
					<pre xml:space="preserve" class="brush: js">private function GrabarDeposito(&nbsp;<br />    <i>x_usuario</i> : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>,&nbsp;<br />    <i>x_entid_codigo</i> : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>,&nbsp;<br />    <i>x_caja_codigo</i> : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>,&nbsp;<br />    <i>x_saldoafavor</i> : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">boolean</a>,&nbsp;<br />    <i>x_fecha</i> : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.datetime.aspx">DateTime</a>,&nbsp;<br />    <i>x_importe</i> : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.decimal.aspx">decimal</a>,&nbsp;<br />    <i>x_tiporecibo</i> : <strong>ETipos</strong>&nbsp;<br />) : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">boolean</a>;</pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>
		
	</div>


<h4 class="subHeading">
	Parámetros</h4><dl paramName="x_usuario">
	<dt>
		<span class="parameter">
			x_usuario
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> 
		</p>
		<p>
			Codigo de usuario 
		</p>
	</dd>
</dl>
<dl paramName="x_entid_codigo">
	<dt>
		<span class="parameter">
			x_entid_codigo
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> 
		</p>
		<p>
			Codifo de entidad 
		</p>
	</dd>
</dl>
<dl paramName="x_caja_codigo">
	<dt>
		<span class="parameter">
			x_caja_codigo
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> 
		</p>
		<p>
			Codigo de Caja 
		</p>
	</dd>
</dl>
<dl paramName="x_saldoafavor">
	<dt>
		<span class="parameter">
			x_saldoafavor
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">bool</a> 
		</p>
		<p>
			Valor que indica si hay saldo a favor, y si puede dar un saldo a favor 
		</p>
	</dd>
</dl>
<dl paramName="x_fecha">
	<dt>
		<span class="parameter">
			x_fecha
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.datetime.aspx">DateTime</a> 
		</p>
		<p>
			 
		</p>
	</dd>
</dl>
<dl paramName="x_importe">
	<dt>
		<span class="parameter">
			x_importe
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.decimal.aspx">decimal</a> 
		</p>
		<p>
			 
		</p>
	</dd>
</dl>
<dl paramName="x_tiporecibo">
	<dt>
		<span class="parameter">
			x_tiporecibo
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <strong>ETipos</strong> 
		</p>
		<p>
			tipo de recibo 
		</p>
	</dd>
</dl>

<p />
<p />

	<h4 class="subHeading">
		Valor devuelto</h4>
  devuelve un valor verdadero si se ejecuta la consulta correctamente













	</div>
</div>





















<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Código fuente</a></span>
		<div><hr /></div>
	</div>

	<div id="sourceCodeSection" class="section">	
		<div class="codeSnippetContainer">		
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCornerActive">
				</div>
				<div class="codeSnippetTab csFirstTab csActiveTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csNaTab csLastTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCorner">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeVB">
					<pre xml:space="preserve" class="brush: vb">
Private Function GrabarDeposito(ByVal x_usuario As String, ByVal x_entid_codigo As String, ByVal x_caja_codigo As String, _
                                 ByVal x_saldoafavor As Boolean, ByVal x_fecha As DateTime, ByVal x_importe As Decimal, ByVal x_tiporecibo As ETipos) As Boolean
    Try
       Dim _bteso_docspagos As New BTESO_DocsPagos(m_pvent_id, m_periodo, m_zonas_codigo, m_sucursal)
       Dim i As Integer = 1
       For Each item As ETESO_DocsPagos In m_listteso_docspagos
          _bteso_docspagos.TESO_DocsPagos = item
          _bteso_docspagos.TESO_DocsPagos.ENTID_Codigo = x_entid_codigo
          If _bteso_docspagos.TESO_DocsPagos.Nuevo Then
             Dim _whereCaja As New Hashtable : _whereCaja.Add(&quot;PVENT_Id&quot;, New ACWhere(_bteso_docspagos.TESO_DocsPagos.PVENT_Id))
             _bteso_docspagos.TESO_DocsPagos.DPAGO_Id = _bteso_docspagos.getCorrelativo(&quot;DPAGO_Id&quot;, _whereCaja)
             _bteso_docspagos.TESO_DocsPagos.DPAGO_Fecha = _bteso_docspagos.TESO_DocsPagos.DPAGO_Fecha.Date
             _bteso_docspagos.TESO_DocsPagos.DPAGO_FechaVenc = _bteso_docspagos.TESO_DocsPagos.DPAGO_FechaVenc.Date
             If _bteso_docspagos.Guardar(x_usuario) Then
                Dim _bteso_cajadocspago As New BTESO_CajaDocsPago
                _bteso_cajadocspago.TESO_CajaDocsPago = New ETESO_CajaDocsPago
                _bteso_cajadocspago.TESO_CajaDocsPago.Instanciar(ACEInstancia.Nuevo)
                _bteso_cajadocspago.TESO_CajaDocsPago.CAJA_Codigo = x_caja_codigo
                _bteso_cajadocspago.TESO_CajaDocsPago.DPAGO_Id = _bteso_docspagos.TESO_DocsPagos.DPAGO_Id
                _bteso_cajadocspago.TESO_CajaDocsPago.CDEPO_Importe = item.DPAGO_Importe
                _bteso_cajadocspago.TESO_CajaDocsPago.CDEPO_Numero = i
                _bteso_cajadocspago.TESO_CajaDocsPago.PVENT_Id = item.PVENT_Id
                _bteso_cajadocspago.Guardar(x_usuario)
                i += 1
             End If
 
             '' Aplicar Saldo A Favor
             If x_saldoafavor Then
                '' Generar Recibo de Ingreso
                Dim _brecibos As New BTESO_Recibos
                _brecibos.TESO_Recibos = New ETESO_Recibos
                _brecibos.TESO_Recibos.Instanciar(ACEInstancia.Nuevo)
 
                _brecibos.TESO_Recibos.TIPOS_CodTransaccion = x_tiporecibo.TIPOS_Codigo
                '' obtiene el tipo de recibo
                If x_tiporecibo.TIPOS_Codigo.Equals(ETipos.getTipo(ETipos.TransaccionTRecibos.AFavorCliente)) Then
                   _brecibos.TESO_Recibos.TIPOS_CodTipoRecibo = ETipos.getTipoComprobante(ETipos.TipoComprobanteVenta.ReciboAFavorCliente)
                ElseIf x_tiporecibo.TIPOS_Codigo.Equals(ETipos.getTipo(ETipos.TransaccionTRecibos.DevolucionCliente)) Then
                   _brecibos.TESO_Recibos.TIPOS_CodTipoRecibo = ETipos.getTipoComprobante(ETipos.TipoComprobanteVenta.ReciboDevolucion)
                ElseIf x_tiporecibo.TIPOS_Codigo.Equals(ETipos.getTipo(ETipos.TransaccionTRecibos.Normal)) Then
                   _brecibos.TESO_Recibos.TIPOS_CodTipoRecibo = ETipos.getTipoComprobante(ETipos.TipoComprobanteVenta.ReciboIngreso)
                ElseIf x_tiporecibo.TIPOS_Codigo.Equals(ETipos.getTipo(ETipos.TransaccionTRecibos.SinRecibo)) Then
                   Return True
                Else
                   _brecibos.TESO_Recibos.TIPOS_CodTipoRecibo = ETipos.getTipoComprobante(ETipos.TipoComprobanteVenta.ReciboIngreso)
                End If
                '' Obtener el numero de serie segun el tipo de recibo
                If _brecibos.GetSeries(m_app, m_zonas_codigo, m_sucursal, m_pvent_id, _brecibos.TESO_Recibos.TIPOS_CodTipoRecibo) Then
                   _brecibos.TESO_Recibos.RECIB_Serie = _brecibos.ListVENT_PVentDocumento(0).PVDOCU_Serie
                   Dim _where As New Hashtable
                   _where.Add(&quot;TIPOS_CodTipoRecibo&quot;, New ACWhere(_brecibos.TESO_Recibos.TIPOS_CodTipoRecibo))
                   _where.Add(&quot;RECIB_Serie&quot;, New ACWhere(_brecibos.TESO_Recibos.RECIB_Serie))
                   _brecibos.TESO_Recibos.RECIB_Numero = _brecibos.getCorrelativo(&quot;RECIB_Numero&quot;, _where)
                End If
                '' Genera el codigo de recibo
                _brecibos.TESO_Recibos.RECIB_Codigo = String.Format(&quot;{0}{1}{2:0000000}&quot;, _brecibos.TESO_Recibos.TIPOS_CodTipoRecibo.Substring(3, 2), _
                                                                           _brecibos.TESO_Recibos.RECIB_Serie.PadLeft(3, &quot;0&quot;), _
                                                                           _brecibos.TESO_Recibos.RECIB_Numero)
                _brecibos.TESO_Recibos.TIPOS_CodTipoMoneda = item.TIPOS_CodTipoMoneda
                _brecibos.TESO_Recibos.PVENT_Id = m_pvent_id
                _brecibos.TESO_Recibos.RECIB_Fecha = x_fecha
                _brecibos.TESO_Recibos.RECIB_RecibiDe = &quot;CAJA - &quot; &amp; x_usuario
                _brecibos.TESO_Recibos.RECIB_Importe = item.DPAGO_Importe - x_importe
                _brecibos.TESO_Recibos.RECIB_Concepto = String.Format(&quot;{3} del deposito {0} OP: {1} ({2:dd/MM/yyyy})&quot;, _
                                                                      item.BANCO_Descripcion, item.DPAGO_Numero, item.DPAGO_Fecha, _
                                                                      x_tiporecibo.TIPOS_Descripcion)
                _brecibos.TESO_Recibos.ENTID_Codigo = x_entid_codigo
                _brecibos.TESO_Recibos.DPAGO_Id = item.DPAGO_Id
                _brecibos.TESO_Recibos.TIPOS_CodTransaccion = ETipos.getTipo(ETipos.TransaccionTRecibos.AFavorCliente)
                _brecibos.Guardar(x_usuario)
             End If
             Return True
          Else
             Dim _bteso_cajadocspago As New BTESO_CajaDocsPago
             _bteso_cajadocspago.TESO_CajaDocsPago = New ETESO_CajaDocsPago
             _bteso_cajadocspago.TESO_CajaDocsPago.Instanciar(ACEInstancia.Nuevo)
             _bteso_cajadocspago.TESO_CajaDocsPago.CAJA_Codigo = x_caja_codigo
             _bteso_cajadocspago.TESO_CajaDocsPago.DPAGO_Id = _bteso_docspagos.TESO_DocsPagos.DPAGO_Id
             _bteso_cajadocspago.TESO_CajaDocsPago.CDEPO_Importe = item.DPAGO_Importe
             _bteso_cajadocspago.TESO_CajaDocsPago.PVENT_Id = item.PVENT_Id
             _bteso_cajadocspago.TESO_CajaDocsPago.CDEPO_Numero = i
             _bteso_cajadocspago.Guardar(x_usuario)
             '' Aplicar Saldo A Favor
             If x_saldoafavor Then
                '' Generar Recibo de Ingreso
                Dim _brecibos As New BTESO_Recibos
                _brecibos.TESO_Recibos = New ETESO_Recibos
                _brecibos.TESO_Recibos.Instanciar(ACEInstancia.Nuevo)
 
                _brecibos.TESO_Recibos.TIPOS_CodTransaccion = x_tiporecibo.TIPOS_Codigo
                If x_tiporecibo.TIPOS_Codigo.Equals(ETipos.getTipo(ETipos.TransaccionTRecibos.AFavorCliente)) Then
                   _brecibos.TESO_Recibos.TIPOS_CodTipoRecibo = ETipos.getTipoComprobante(ETipos.TipoComprobanteVenta.ReciboAFavorCliente)
                ElseIf x_tiporecibo.TIPOS_Codigo.Equals(ETipos.getTipo(ETipos.TransaccionTRecibos.DevolucionCliente)) Then
                   _brecibos.TESO_Recibos.TIPOS_CodTipoRecibo = ETipos.getTipoComprobante(ETipos.TipoComprobanteVenta.ReciboDevolucion)
                ElseIf x_tiporecibo.TIPOS_Codigo.Equals(ETipos.getTipo(ETipos.TransaccionTRecibos.Normal)) Then
                   _brecibos.TESO_Recibos.TIPOS_CodTipoRecibo = ETipos.getTipoComprobante(ETipos.TipoComprobanteVenta.ReciboIngreso)
                ElseIf x_tiporecibo.TIPOS_Codigo.Equals(ETipos.getTipo(ETipos.TransaccionTRecibos.SinRecibo)) Then
                   Return True
                Else
                   _brecibos.TESO_Recibos.TIPOS_CodTipoRecibo = ETipos.getTipoComprobante(ETipos.TipoComprobanteVenta.ReciboIngreso)
                End If
                '' Obtener el numero de serie segun el tipo de recibo
                If _brecibos.GetSeries(m_app, m_zonas_codigo, m_sucursal, m_pvent_id, _brecibos.TESO_Recibos.TIPOS_CodTipoRecibo) Then
                   _brecibos.TESO_Recibos.RECIB_Serie = _brecibos.ListVENT_PVentDocumento(0).PVDOCU_Serie
                   Dim _where As New Hashtable
                   _where.Add(&quot;TIPOS_CodTipoRecibo&quot;, New ACWhere(_brecibos.TESO_Recibos.TIPOS_CodTipoRecibo))
                   _where.Add(&quot;RECIB_Serie&quot;, New ACWhere(_brecibos.TESO_Recibos.RECIB_Serie))
                   _brecibos.TESO_Recibos.RECIB_Numero = _brecibos.getCorrelativo(&quot;RECIB_Numero&quot;, _where)
                End If
                '' Genera el codigo de recibo
                _brecibos.TESO_Recibos.RECIB_Codigo = String.Format(&quot;{0}{1}{2:0000000}&quot;, _brecibos.TESO_Recibos.TIPOS_CodTipoRecibo.Substring(3, 2), _
                                                                           _brecibos.TESO_Recibos.RECIB_Serie.PadLeft(3, &quot;0&quot;), _
                                                                           _brecibos.TESO_Recibos.RECIB_Numero)
                _brecibos.TESO_Recibos.TIPOS_CodTipoMoneda = item.TIPOS_CodTipoMoneda
                _brecibos.TESO_Recibos.PVENT_Id = m_pvent_id
                _brecibos.TESO_Recibos.RECIB_Fecha = x_fecha
                _brecibos.TESO_Recibos.RECIB_RecibiDe = &quot;CAJA - &quot; &amp; x_usuario
                _brecibos.TESO_Recibos.RECIB_Importe = item.DPAGO_Importe - x_importe
                _brecibos.TESO_Recibos.RECIB_Concepto = String.Format(&quot;{3} del deposito {0} OP: {1} ({2:dd/MM/yyyy})&quot;, _
                                                                      item.BANCO_Descripcion, item.DPAGO_Numero, item.DPAGO_Fecha, _
                                                                      x_tiporecibo.TIPOS_Descripcion)
                _brecibos.TESO_Recibos.ENTID_Codigo = x_entid_codigo
                _brecibos.TESO_Recibos.DPAGO_Id = item.DPAGO_Id
                _brecibos.TESO_Recibos.TIPOS_CodTransaccion = ETipos.getTipo(ETipos.TransaccionTRecibos.AFavorCliente)
                _brecibos.Guardar(x_usuario)
             End If
             Return True
          End If
       Next
    Catch ex As Exception
       Throw ex
    End Try
 End Function
					</pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>

	</div>					
</div>



<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Plataformas</a></span>
		<div><hr /></div>
	</div>

	<div id="platformsSection" class="section">	
		<p>
			Windows 8, Windows Server 2012, Windows 7, Windows Vista SP1 or later, Windows XP SP3, Windows XP SP2 x64 Edition, Windows Server 2008 (Server Core not supported), Windows Server 2008 R2 (Server Core supported with SP1 or later), Windows Server 2003 SP2
		</p>
		<p>
			.NET Framework no admite todas las versiones de cada plataforma. Para obtener una lista de las versiones admitidas, vea 
			<a target="_top" href="http://msdn2.microsoft.com/en-us/library/298275e2-da1d-4618-9f74-6a3567832350.aspx">System Requirements</a>.
		</p>
	</div>					
</div>



  

	

	
	

<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Información de versión</a></span>
		<div><hr /></div>
	</div>

	<div id="frameworksSection" class="section">	
  <h4 class="subHeading">.NET Framework</h4>Supported in: 4.5, 4, 3.5, 3.0, 2.0, 1.1, 1.0<br />

	<h4 class="subHeading">.NET Compact Framework</h4>Supported in: 3.5, 2.0, 1.0<br />

	<h4 class="subHeading">XNA Framework</h4>Supported in: 3.0, 2.0, 1.0<br />
	
	</div>					
</div>

<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Vea también</a></span>
		<div><hr /></div>
	</div>

	<div id="seeAlsoSection" class="section">	
		<div>
			<h4 class="subHeading">
				Referencia</h4>
			<a href="topic_00000000000007BE.html">BAdminCaja (Clase)</a><br />
<a href="topic_00000000000007BE_members--.html">BAdminCaja (Miembros)</a><br />




			

		</div>
	</div>					
</div>
			</div>
			</div>
      <div id="footer">
      	<p><span style="color: #FF0000;">Generated with unregistered version of <a target="_top" href="http://www.helixoft.com/vsdocman/overview.html">VSdocman</a></span>&nbsp;<br />Your own footer text will only be shown in registered version.</p>
      </div>
    </div>
  	<script type="text/javascript">
<!--
	try {
		parent.frames["vbdocswitch"].expandLinkInToc(location.href);
	} catch (ex) {}
//-->
		</script>	
  </body>
</html>

