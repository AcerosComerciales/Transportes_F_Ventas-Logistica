<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="GENERATOR" content="VSdocman - documentation generator; http://www.helixoft.com" />
	<title>BReporte.RCuadreCaja (Método)</title>

	<link rel="stylesheet" type="text/css" href="msdn10_lightweight/msdn10_lightweight.css"></link>
	<script src="msdn10_lightweight/msdn10_lightweight.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shCore_helixoft.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushVb.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushCSharp.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushCpp.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushJScript.js" type="text/javascript"></script>
	<link href="SyntaxHighlighter/styles/shCore.css" rel="stylesheet" type="text/css" />
	<link href="SyntaxHighlighter/styles/shThemeMsdnLW.css" rel="stylesheet" type="text/css" />
	<script type="text/javascript">
		SyntaxHighlighter.all();
	</script>				

	<script type="text/javascript">
<!--
if (self.name != "vbdocright") {
	if (location.search != "?toc=no") {
		var filename = location.pathname.replace(/\\/g, "/");
		filename = filename.substring(filename.lastIndexOf('/')+1);
		location.replace("index.html#" + filename);
	} 
}

function replaceTitleAndUrl(win, title, url) {
	if(history.replaceState) {
		win.history.replaceState(null, title, url);
	} else {
		win.document.title = document.title;
		win.location.replace(url);
	}
}
//-->
	</script>	
</head>

<body style="direction: ltr;">
	<script type="text/javascript">
		try {
			if (location.search != "?toc=no") {
				parent.document.title = document.title;
				var filename = location.pathname.replace(/\\/g, "/");
				filename = filename.substring(filename.lastIndexOf('/')+1);
				if (window.parent.location.search == null || window.parent.location.search != "?" + filename) {
					if (window.parent.location.hash == null || window.parent.location.hash != "#" + filename) {
						replaceTitleAndUrl(window.parent, document.title, "index.html#" + filename);
					}
				}
			}
		} catch (ex) {}
	</script>
	<div id="topic">
<!--HEADER START-->
  <div id="header">
  	<div id="runningHeaderText">ACBVentas Reference</div>
  	<h1 class="title">BReporte.RCuadreCaja (Método)</h1>
  	<div id="headerLinks">

	<a href="#seeAlsoSection">Vea también</a>

		</div>
		<hr />
	</div>
<!--HEADER END-->
    
		<div id="mainSection">
      <div id="mainBody">
        <p />
       



        <br /><strong>Ensamblado:</strong> ACBVentas (in ACBVentas.dll)











<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Sintaxis</a></span>
		<div><hr /></div>
	</div>

	<div id="syntaxSection" class="section">	
	
	
	<div id="syntaxCodeBlocks">
		<div class="codeSnippetContainer">		
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCornerActive">
				</div>
				<div class="codeSnippetTab csFirstTab csActiveTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csLastTab csNaTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCorner">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeVB">
					<pre xml:space="preserve" class="brush: vb">Public Function RCuadreCaja( _&nbsp;<br />   ByVal <i>x_fecini</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.datetime.aspx">Date</a>, _&nbsp;<br />   ByVal <i>x_fecfin</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.datetime.aspx">Date</a>, _&nbsp;<br />   ByVal <i>x_pvent_id</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.int64.aspx">Long</a>, _&nbsp;<br />   ByVal <i>x_trcuadrecaja</i> As <a target="_top" href="topic_000000000000093D.html" onclick="this.target='';return true;">TRCuadreCaja</a> _&nbsp;<br />) As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">Boolean</a></pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>
		
		<div class="codeSnippetContainer">
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCorner">
				</div>
				<div class="codeSnippetTab csFirstTab csNaTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csActiveTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csLastTab csNaTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCorner">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeCsharp">
					<pre xml:space="preserve" class="brush: csharp">public <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">bool</a> RCuadreCaja(&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.datetime.aspx">DateTime</a> <i>x_fecini</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.datetime.aspx">DateTime</a> <i>x_fecfin</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.int64.aspx">long</a> <i>x_pvent_id</i>,&nbsp;<br />   <a target="_top" href="topic_000000000000093D.html" onclick="this.target='';return true;">TRCuadreCaja</a> <i>x_trcuadrecaja</i>&nbsp;<br />)</pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>

		<div class="codeSnippetContainer">
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCorner">
				</div>
				<div class="codeSnippetTab csFirstTab csNaTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csActiveTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csLastTab csNaTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCorner">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeCpp">
					<pre xml:space="preserve" class="brush: cpp">public: &nbsp;<br /><a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">bool</a> RCuadreCaja(&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.datetime.aspx">DateTime</a> <i>x_fecini</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.datetime.aspx">DateTime</a> <i>x_fecfin</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.int64.aspx">long</a> <i>x_pvent_id</i>,&nbsp;<br />   <a target="_top" href="topic_000000000000093D.html" onclick="this.target='';return true;">TRCuadreCaja</a> <i>x_trcuadrecaja</i>&nbsp;<br />) </pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>
		
		<div class="codeSnippetContainer">
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCorner">
				</div>
				<div class="codeSnippetTab csFirstTab csNaTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csActiveTab csLastTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCornerActive">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeJScript">
					<pre xml:space="preserve" class="brush: js">public function RCuadreCaja(&nbsp;<br />    <i>x_fecini</i> : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.datetime.aspx">DateTime</a>,&nbsp;<br />    <i>x_fecfin</i> : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.datetime.aspx">DateTime</a>,&nbsp;<br />    <i>x_pvent_id</i> : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.int64.aspx">long</a>,&nbsp;<br />    <i>x_trcuadrecaja</i> : <a target="_top" href="topic_000000000000093D.html" onclick="this.target='';return true;">TRCuadreCaja</a>&nbsp;<br />) : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">boolean</a>;</pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>
		
	</div>


<h4 class="subHeading">
	Parámetros</h4><dl paramName="x_fecini">
	<dt>
		<span class="parameter">
			x_fecini
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.datetime.aspx">DateTime</a> 
		</p>
		<p>
			 
		</p>
	</dd>
</dl>
<dl paramName="x_fecfin">
	<dt>
		<span class="parameter">
			x_fecfin
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.datetime.aspx">DateTime</a> 
		</p>
		<p>
			 
		</p>
	</dd>
</dl>
<dl paramName="x_pvent_id">
	<dt>
		<span class="parameter">
			x_pvent_id
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.int64.aspx">long</a> 
		</p>
		<p>
			 
		</p>
	</dd>
</dl>
<dl paramName="x_trcuadrecaja">
	<dt>
		<span class="parameter">
			x_trcuadrecaja
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <a target="_top" href="topic_000000000000093D.html" onclick="this.target='';return true;">TRCuadreCaja</a> 
		</p>
		<p>
			 
		</p>
	</dd>
</dl>

<p />
<p />














	</div>
</div>





















<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Código fuente</a></span>
		<div><hr /></div>
	</div>

	<div id="sourceCodeSection" class="section">	
		<div class="codeSnippetContainer">		
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCornerActive">
				</div>
				<div class="codeSnippetTab csFirstTab csActiveTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csNaTab csLastTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCorner">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeVB">
					<pre xml:space="preserve" class="brush: vb">
Public Function RCuadreCaja(ByVal x_fecini As Date, ByVal x_fecfin As Date, ByVal x_pvent_id As Long, ByVal x_trcuadrecaja As TRCuadreCaja) As Boolean
    Dim m_listCuadreCaja_Facturas As New List(Of ECCuadreCaja)
    Dim m_listCuadreCaja_Egreso As New List(Of ECCuadreCaja)
    Dim m_listCuadreCaja_Ingreso As New List(Of ECCuadreCaja)
    Dim m_listCuadreCaja_Efectivo As New List(Of ECCuadreCaja)
    m_saldocaja = New ESaldoCaja
    m_saldocajaefectivo = New ESaldoCaja
    m_listcuadrecaja = New List(Of ECCuadreCaja)
    Try
       If d_reporte.VENT_CAJASS_CuadreCaja_Facturas(m_listCuadreCaja_Facturas, x_fecini, x_fecfin, x_pvent_id, x_trcuadrecaja) Then
          m_listcuadrecaja = New List(Of ECCuadreCaja)(m_listCuadreCaja_Facturas)
       End If
       If d_reporte.VENT_CAJASS_CuadreCaja_Ingresos(m_listCuadreCaja_Ingreso, x_fecini, x_fecfin, x_pvent_id, x_trcuadrecaja) Then
          For Each item As ECCuadreCaja In m_listCuadreCaja_Ingreso
             m_listcuadrecaja.Add(item)
          Next
       End If
       If d_reporte.VENT_CAJASS_CuadreCaja_Egresos(m_listCuadreCaja_Egreso, x_fecini, x_fecfin, x_pvent_id, x_trcuadrecaja) Then
          For Each item As ECCuadreCaja In m_listCuadreCaja_Egreso
             m_listcuadrecaja.Add(item)
          Next
       End If
 
       d_reporte.VENT_CAJASS_SaldoInicial(m_saldocaja, x_fecini, x_pvent_id, x_trcuadrecaja)
 
       Select Case x_trcuadrecaja
          Case TRCuadreCaja.Actual
 
          Case TRCuadreCaja.Nuevo
             d_reporte.VENT_CCAJASS_SaldoInicialEfectivo(m_saldocajaefectivo, x_fecini, x_fecfin, m_pvent_id)
             Dim _caja As New ECCuadreCaja
             _caja.Orden = 4
             _caja.Titulo = &quot;Movimiento de Efectivo&quot;
             _caja.Title = &quot;04.- Movimiento de Efectivo&quot;
             _caja.Fecha = x_fecini
             _caja.ENTID_Codigo = &quot;0000000000&quot;
             _caja.Detalle = String.Format(&quot;Saldo Inicial al dia{0:dd/MM/yyyy}&quot;, x_fecini.AddDays(-1))
             _caja.ENTID_RazonSocial = String.Format(&quot;Saldo Inicial al dia{0:dd/MM/yyyy}&quot;, x_fecini.AddDays(-1))
             _caja.ImpSoles = m_saldocajaefectivo.Ingreso
             _caja.ImpDolares = m_saldocajaefectivo.IngresoDol
             _caja.Moneda = &quot;&quot;
             _caja.Documento = String.Format(&quot; SI-{1:yyyymmdd}&quot;, m_pvent_id, x_fecini.AddDays(-1))
             m_listCuadreCaja_Efectivo.Add(_caja)
             If d_reporte.VENT_CCAJASS_Efectivo(m_listCuadreCaja_Efectivo, x_fecini, x_fecfin, x_pvent_id) Then
                For Each item As ECCuadreCaja In m_listCuadreCaja_Efectivo
                   m_listcuadrecaja.Add(item)
                Next
             End If
 
       End Select
 
 
       '' Calcular Saldos
       Dim _importe_fcfac As Decimal = 0 : Dim _importe_fcfac_dol As Decimal = 0
       Dim _importe_oi As Decimal = 0 : Dim _importe_oi_dol As Decimal = 0
       Dim _importe_re As Decimal = 0 : Dim _importe_re_dol As Decimal = 0
       Dim _importe_gviaje As Decimal = 0 : Dim _importe_gviaje_dol As Decimal = 0
       For Each item As ECCuadreCaja In m_listcuadrecaja
          If item.Orden = 2 Then
             Dim i As Integer = 0
          End If
          If Not IsNothing(item.ENTID_RazonSocial) Then item.ENTID_RazonSocial = item.ENTID_RazonSocial.Replace(vbCrLf, &quot; &quot;)
          Select Case item.Orden
             Case TipoDocumento.DocumentosVenta
                _importe_fcfac += item.ImpSoles
                _importe_fcfac_dol += item.ImpDolares
             Case TipoDocumento.OtrosIngresos
                _importe_oi += item.ImpSoles
                _importe_oi_dol += item.ImpDolares
             Case TipoDocumento.RecibosEgreso
                _importe_re += item.ImpSoles
                _importe_re_dol += item.ImpDolares
             Case TipoDocumento.GastosViaje
                _importe_gviaje += item.ImpSoles
                _importe_gviaje_dol += item.ImpDolares
             Case Else
 
          End Select
       Next
 
 
 
 
       m_saldocaja.Ingreso = _importe_fcfac + _importe_oi ' m_saldocaja.SaldoInicial  
       m_saldocaja.IngresoDol = _importe_fcfac_dol + _importe_oi_dol ' m_saldocaja.SaldoInicialDol 
       m_saldocaja.Egreso = _importe_re
       m_saldocaja.EgresoDol = _importe_re_dol
       m_saldocaja.Saldo = (m_saldocaja.SaldoInicial + m_saldocaja.Ingreso) - m_saldocaja.Egreso
       m_saldocaja.SaldoDol = (m_saldocaja.SaldoInicialDol + m_saldocaja.IngresoDol) - m_saldocaja.EgresoDol
       Return m_listcuadrecaja.Count &gt; 0
    Catch ex As Exception
       Throw ex
    End Try
 End Function
					</pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>

	</div>					
</div>



<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Plataformas</a></span>
		<div><hr /></div>
	</div>

	<div id="platformsSection" class="section">	
		<p>
			Windows 8, Windows Server 2012, Windows 7, Windows Vista SP1 or later, Windows XP SP3, Windows XP SP2 x64 Edition, Windows Server 2008 (Server Core not supported), Windows Server 2008 R2 (Server Core supported with SP1 or later), Windows Server 2003 SP2
		</p>
		<p>
			.NET Framework no admite todas las versiones de cada plataforma. Para obtener una lista de las versiones admitidas, vea 
			<a target="_top" href="http://msdn2.microsoft.com/en-us/library/298275e2-da1d-4618-9f74-6a3567832350.aspx">System Requirements</a>.
		</p>
	</div>					
</div>



  

	

	
	

<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Información de versión</a></span>
		<div><hr /></div>
	</div>

	<div id="frameworksSection" class="section">	
  <h4 class="subHeading">.NET Framework</h4>Supported in: 4.5, 4, 3.5, 3.0, 2.0, 1.1, 1.0<br />

	<h4 class="subHeading">.NET Compact Framework</h4>Supported in: 3.5, 2.0, 1.0<br />

	<h4 class="subHeading">XNA Framework</h4>Supported in: 3.0, 2.0, 1.0<br />
	
	</div>					
</div>

<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Vea también</a></span>
		<div><hr /></div>
	</div>

	<div id="seeAlsoSection" class="section">	
		<div>
			<h4 class="subHeading">
				Referencia</h4>
			<a href="topic_0000000000000927.html">BReporte (Clase)</a><br />
<a href="topic_0000000000000927_members--.html">BReporte (Miembros)</a><br />




			

		</div>
	</div>					
</div>
			</div>
			</div>
      <div id="footer">
      	<p><span style="color: #FF0000;">Generated with unregistered version of <a target="_top" href="http://www.helixoft.com/vsdocman/overview.html">VSdocman</a></span>&nbsp;<br />Your own footer text will only be shown in registered version.</p>
      </div>
    </div>
  	<script type="text/javascript">
<!--
	try {
		parent.frames["vbdocswitch"].expandLinkInToc(location.href);
	} catch (ex) {}
//-->
		</script>	
  </body>
</html>

