<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="GENERATOR" content="VSdocman - documentation generator; http://www.helixoft.com" />
	<title>BEntidades.Guardar (String, TipoInicializacion) (Método)</title>

	<link rel="stylesheet" type="text/css" href="msdn10_lightweight/msdn10_lightweight.css"></link>
	<script src="msdn10_lightweight/msdn10_lightweight.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shCore_helixoft.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushVb.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushCSharp.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushCpp.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushJScript.js" type="text/javascript"></script>
	<link href="SyntaxHighlighter/styles/shCore.css" rel="stylesheet" type="text/css" />
	<link href="SyntaxHighlighter/styles/shThemeMsdnLW.css" rel="stylesheet" type="text/css" />
	<script type="text/javascript">
		SyntaxHighlighter.all();
	</script>				

	<script type="text/javascript">
<!--
if (self.name != "vbdocright") {
	if (location.search != "?toc=no") {
		var filename = location.pathname.replace(/\\/g, "/");
		filename = filename.substring(filename.lastIndexOf('/')+1);
		location.replace("index.html#" + filename);
	} 
}

function replaceTitleAndUrl(win, title, url) {
	if(history.replaceState) {
		win.history.replaceState(null, title, url);
	} else {
		win.document.title = document.title;
		win.location.replace(url);
	}
}
//-->
	</script>	
</head>

<body style="direction: ltr;">
	<script type="text/javascript">
		try {
			if (location.search != "?toc=no") {
				parent.document.title = document.title;
				var filename = location.pathname.replace(/\\/g, "/");
				filename = filename.substring(filename.lastIndexOf('/')+1);
				if (window.parent.location.search == null || window.parent.location.search != "?" + filename) {
					if (window.parent.location.hash == null || window.parent.location.hash != "#" + filename) {
						replaceTitleAndUrl(window.parent, document.title, "index.html#" + filename);
					}
				}
			}
		} catch (ex) {}
	</script>
	<div id="topic">
<!--HEADER START-->
  <div id="header">
  	<div id="runningHeaderText">ACBVentas Reference</div>
  	<h1 class="title">BEntidades.Guardar (String, TipoInicializacion) (Método)</h1>
  	<div id="headerLinks">

	<a href="#seeAlsoSection">Vea también</a>

		</div>
		<hr />
	</div>
<!--HEADER END-->
    
		<div id="mainSection">
      <div id="mainBody">
        <p />
       
        Guaradar la entidad, con todos sus datos adicionales



        <br /><strong>Ensamblado:</strong> ACBVentas (in ACBVentas.dll)











<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Sintaxis</a></span>
		<div><hr /></div>
	</div>

	<div id="syntaxSection" class="section">	
	
	
	<div id="syntaxCodeBlocks">
		<div class="codeSnippetContainer">		
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCornerActive">
				</div>
				<div class="codeSnippetTab csFirstTab csActiveTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csLastTab csNaTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCorner">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeVB">
					<pre xml:space="preserve" class="brush: vb">Public Function Guardar( _&nbsp;<br />   ByVal <i>x_usuario</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>, _&nbsp;<br />   ByVal <i>x_inicio</i> As <strong>TipoInicializacion</strong> _&nbsp;<br />) As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">Boolean</a></pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>
		
		<div class="codeSnippetContainer">
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCorner">
				</div>
				<div class="codeSnippetTab csFirstTab csNaTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csActiveTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csLastTab csNaTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCorner">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeCsharp">
					<pre xml:space="preserve" class="brush: csharp">public <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">bool</a> Guardar(&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> <i>x_usuario</i>,&nbsp;<br />   <strong>TipoInicializacion</strong> <i>x_inicio</i>&nbsp;<br />)</pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>

		<div class="codeSnippetContainer">
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCorner">
				</div>
				<div class="codeSnippetTab csFirstTab csNaTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csActiveTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csLastTab csNaTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCorner">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeCpp">
					<pre xml:space="preserve" class="brush: cpp">public: &nbsp;<br /><a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">bool</a> Guardar(&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>^ <i>x_usuario</i>,&nbsp;<br />   <strong>TipoInicializacion</strong> <i>x_inicio</i>&nbsp;<br />) </pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>
		
		<div class="codeSnippetContainer">
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCorner">
				</div>
				<div class="codeSnippetTab csFirstTab csNaTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csActiveTab csLastTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCornerActive">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeJScript">
					<pre xml:space="preserve" class="brush: js">public function Guardar(&nbsp;<br />    <i>x_usuario</i> : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>,&nbsp;<br />    <i>x_inicio</i> : <strong>TipoInicializacion</strong>&nbsp;<br />) : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">boolean</a>;</pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>
		
	</div>


<h4 class="subHeading">
	Parámetros</h4><dl paramName="x_usuario">
	<dt>
		<span class="parameter">
			x_usuario
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> 
		</p>
		<p>
			codigo de usuario 
		</p>
	</dd>
</dl>
<dl paramName="x_inicio">
	<dt>
		<span class="parameter">
			x_inicio
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <strong>TipoInicializacion</strong> 
		</p>
		<p>
			tipo de inicializacion o datos que trae la entida para se grabados 
		</p>
	</dd>
</dl>

<p />
<p />














	</div>
</div>





















<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Código fuente</a></span>
		<div><hr /></div>
	</div>

	<div id="sourceCodeSection" class="section">	
		<div class="codeSnippetContainer">		
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCornerActive">
				</div>
				<div class="codeSnippetTab csFirstTab csActiveTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csNaTab csLastTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCorner">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeVB">
					<pre xml:space="preserve" class="brush: vb">
Public Function Guardar(ByVal x_usuario As String, ByVal x_inicio As EEntidades.TipoInicializacion) As Boolean
    Try
       DAEnterprise.BeginTransaction()
       'Dim d_entidades As New DEntidades()
       If m_entidades.Nuevo Then
          m_entidades.ENTID_Estado = BConstantes.getEstado(BConstantes.Estados.Activo)
          m_entidades.ENTID_Id = getCorrelativo(&quot;ENTID_Id&quot;)
 
          For Each Item As EEntidadesRoles In m_entidades.ListEntidadesTipos
             If Item.ROLES_Id = CType(EEntidades.TipoEntidad.Usuarios, Integer) Then
                Dim ptrM As Integer = m_entidades.ENTID_PtrApeMaterno
                Dim ptrN1 As Integer = m_entidades.ENTID_PtrNombre1
                Dim _long As Integer = m_entidades.ENTID_Nombres.Length
                Dim _usuario As String = &quot;&quot;
                If ptrM + ptrN1 &gt; 0 Then
                   Dim txtNombres As String = m_entidades.ENTID_Nombres.Substring(ptrN1, _long - ptrN1)
                   Dim txtApePaterno As String = m_entidades.ENTID_Nombres.Substring(0, ptrM - 1)
                   Dim txtApeMaterno As String = m_entidades.ENTID_Nombres.Substring(ptrM, _long - (_long - ptrN1) - ptrM - 1)
                   _usuario = String.Format(&quot;{0}{1}{2}&quot;, txtNombres.Substring(0, 1), txtApePaterno.Trim(), txtApeMaterno.Substring(0, 1))
                End If
                m_entidades.ENTID_CodUsuario = _usuario
             End If
          Next
 
          d_entidades.ENTIDSI_UnReg(m_entidades, x_usuario)
       ElseIf m_entidades.Modificado Then
          d_entidades.ENTIDSU_UnReg(m_entidades, x_usuario)
       ElseIf m_entidades.Eliminado Then
          Dim _entidad As New EEntidades() With {.ENTID_Id = m_entidades.ENTID_Id, .ENTID_Estado = BConstantes.getEstado(BConstantes.Estados.Anulado)}
          d_entidades.ENTIDSU_UnReg(_entidad, x_usuario)
          DAEnterprise.CommitTransaction()
          Return True
       End If
       '' Guardar el detalle
       Select Case x_inicio
          Case EEntidades.TipoInicializacion.EntTipos_Dir_Tel
             '' Direcciones
             '' Guardar
             For Each Item As EDirecciones In m_entidades.ListDirecciones
                Item.ENTID_Codigo = m_entidades.ENTID_Codigo
                If Item.Nuevo Then
                   Dim _direcciones As New BDirecciones()
                   Item.DIREC_Id = _direcciones.getIdDireccion(Item.ENTID_Codigo)
                End If
                Dim _bdirecciones As New BDirecciones() With {.Direcciones = Item}
                _bdirecciones.Guardar(x_usuario)
             Next
             '' Eliminar
             If Not IsNothing(m_ListEliDirecciones) Then
                For Each Item As EDirecciones In m_ListEliDirecciones
                   Item.ENTID_Codigo = m_entidades.ENTID_Codigo
                   Dim _bdirecciones As New BDirecciones() With {.Direcciones = Item}
                   _bdirecciones.Guardar(x_usuario)
                Next
             End If
             '' Telefonos
             '' Guardar
             For Each Item As ETelefonos In m_entidades.ListTelefonos
                Item.ENTID_Codigo = m_entidades.ENTID_Codigo
 
                Dim _btelefonos As New BTelefonos() With {.Telefonos = Item}
                If Item.Nuevo Then _btelefonos.Telefonos.TELEF_ID = _btelefonos.getCorrelativo(&quot;TELEF_ID&quot;)
                _btelefonos.Guardar(x_usuario)
             Next
             '' Eliminar
             If Not IsNothing(m_ListEliTelefonos) Then
                For Each Item As ETelefonos In m_ListEliTelefonos
                   Item.ENTID_Codigo = m_entidades.ENTID_Codigo
                   Dim _btelefonos As New BTelefonos() With {.Telefonos = Item}
                   _btelefonos.Guardar(x_usuario)
                Next
             End If
             '' Entidades Tipos
             For Each Item As EEntidadesRoles In m_entidades.ListEntidadesTipos
                Item.ENTID_Codigo = m_entidades.ENTID_Codigo
                Dim _benti As New BEntidadesRoles() With {.EntidadesRoles = Item}
                _benti.Guardar(x_usuario)
             Next
          Case 2
 
          Case Else
 
       End Select
       '' Guardar Tablas adicionales a la entidad
       '' Guardar Cliente
       If Not IsNothing(m_entidades.Cliente) Then
          Dim m_cliente As New BClientes
          If m_cliente.Cargar(m_entidades.ENTID_Codigo) Then
             m_entidades.Cliente.Instanciar(ACEInstancia.Modificado)
          Else
             m_entidades.Cliente.Instanciar(ACEInstancia.Nuevo)
          End If
          m_entidades.Cliente.ENTID_Codigo = m_entidades.ENTID_Codigo
          m_cliente.setClientes(m_entidades.Cliente)
          If Not m_cliente.Guardar(x_usuario) Then
             DAEnterprise.RollBackTransaction()
             Return False
          End If
       End If
       '' Guardar Proveedor
       If Not IsNothing(m_entidades.Proveedor) Then
          Dim m_proveedor As New BProveedores
          m_entidades.Proveedor.ENTID_Codigo = m_entidades.ENTID_Codigo
          m_proveedor.setProveedores(m_entidades.Proveedor)
          If Not m_proveedor.Guardar(x_usuario) Then
             DAEnterprise.RollBackTransaction()
             Return False
          End If
       End If
       '' Guardar Conductor
       If Not IsNothing(m_entidades.Conductor) Then
          Dim m_conductor As New BConductores
          If m_conductor.Cargar(m_entidades.ENTID_Codigo) Then
             m_entidades.Conductor.Instanciar(ACEInstancia.Modificado)
          Else
             m_entidades.Conductor.Instanciar(ACEInstancia.Nuevo)
          End If
          m_entidades.Conductor.ENTID_Codigo = m_entidades.ENTID_Codigo
          m_conductor.Conductores = m_entidades.Conductor
          If Not m_conductor.Guardar(x_usuario) Then
             DAEnterprise.RollBackTransaction()
             Return False
          End If
          If Not IsNothing(m_entidades.Conductor.Transportista) Then
             Dim _relac As New BEntidadRelacion
             Dim _where As New Hashtable
             _where.Add(&quot;ENTID_Codigo&quot;, New ACWhere(m_entidades.Conductor.Transportista.ENTID_Codigo))
             _where.Add(&quot;ENTID_CodRelacion&quot;, New ACWhere(m_entidades.Conductor.ENTID_Codigo))
             _where.Add(&quot;TIPOS_CodTipoRelacion&quot;, New ACWhere(ETipos.getTipo(ETipos.TipoEntidadRelacion.Conductor)))
             If Not _relac.Cargar(_where) Then
                _relac.EntidadRelacion = New EEntidadRelacion
                _relac.EntidadRelacion.Instanciar(ACEInstancia.Nuevo)
                _relac.EntidadRelacion.ENTID_Codigo = m_entidades.Conductor.Transportista.ENTID_Codigo
                _relac.EntidadRelacion.ENTID_CodRelacion = m_entidades.Conductor.ENTID_Codigo
                _relac.EntidadRelacion.TIPOS_CodTipoRelacion = ETipos.getTipo(ETipos.TipoEntidadRelacion.Conductor)
                Dim _wherecor As New Hashtable
                _wherecor.Add(&quot;ENTID_Codigo&quot;, New ACWhere(_relac.EntidadRelacion.ENTID_Codigo))
                _relac.EntidadRelacion.ENTRE_Numero = _relac.getCorrelativo(&quot;ENTRE_Numero&quot;, _wherecor)
                If _relac.EntidadRelacion.ENTID_Codigo.Length &gt;= 8 Then
                   _relac.Guardar(x_usuario)
                End If
             End If
          End If
 
       End If
       '' Completar la operacion cerrando la transacción
       DAEnterprise.CommitTransaction()
       Return True
    Catch ex As Exception
       DAEnterprise.RollBackTransaction()
       Throw ex
    End Try
 End Function
					</pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>

	</div>					
</div>



<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Plataformas</a></span>
		<div><hr /></div>
	</div>

	<div id="platformsSection" class="section">	
		<p>
			Windows 8, Windows Server 2012, Windows 7, Windows Vista SP1 or later, Windows XP SP3, Windows XP SP2 x64 Edition, Windows Server 2008 (Server Core not supported), Windows Server 2008 R2 (Server Core supported with SP1 or later), Windows Server 2003 SP2
		</p>
		<p>
			.NET Framework no admite todas las versiones de cada plataforma. Para obtener una lista de las versiones admitidas, vea 
			<a target="_top" href="http://msdn2.microsoft.com/en-us/library/298275e2-da1d-4618-9f74-6a3567832350.aspx">System Requirements</a>.
		</p>
	</div>					
</div>



  

	

	
	

<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Información de versión</a></span>
		<div><hr /></div>
	</div>

	<div id="frameworksSection" class="section">	
  <h4 class="subHeading">.NET Framework</h4>Supported in: 4.5, 4, 3.5, 3.0, 2.0, 1.1, 1.0<br />

	<h4 class="subHeading">.NET Compact Framework</h4>Supported in: 3.5, 2.0, 1.0<br />

	<h4 class="subHeading">XNA Framework</h4>Supported in: 3.0, 2.0, 1.0<br />
	
	</div>					
</div>

<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Vea también</a></span>
		<div><hr /></div>
	</div>

	<div id="seeAlsoSection" class="section">	
		<div>
			<h4 class="subHeading">
				Referencia</h4>
			<a href="topic_00000000000004A9.html">BEntidades (Clase)</a><br />
<a href="topic_00000000000004A9_members--.html">BEntidades (Miembros)</a><br />




			

		</div>
	</div>					
</div>
			</div>
			</div>
      <div id="footer">
      	<p><span style="color: #FF0000;">Generated with unregistered version of <a target="_top" href="http://www.helixoft.com/vsdocman/overview.html">VSdocman</a></span>&nbsp;<br />Your own footer text will only be shown in registered version.</p>
      </div>
    </div>
  	<script type="text/javascript">
<!--
	try {
		parent.frames["vbdocswitch"].expandLinkInToc(location.href);
	} catch (ex) {}
//-->
		</script>	
  </body>
</html>

