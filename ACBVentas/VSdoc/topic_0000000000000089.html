<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="GENERATOR" content="VSdocman - documentation generator; http://www.helixoft.com" />
	<title>BVENT_DocsVenta.EliminarDocumentoVenta (Método)</title>

	<link rel="stylesheet" type="text/css" href="msdn10_lightweight/msdn10_lightweight.css"></link>
	<script src="msdn10_lightweight/msdn10_lightweight.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shCore_helixoft.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushVb.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushCSharp.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushCpp.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushJScript.js" type="text/javascript"></script>
	<link href="SyntaxHighlighter/styles/shCore.css" rel="stylesheet" type="text/css" />
	<link href="SyntaxHighlighter/styles/shThemeMsdnLW.css" rel="stylesheet" type="text/css" />
	<script type="text/javascript">
		SyntaxHighlighter.all();
	</script>				

	<script type="text/javascript">
<!--
if (self.name != "vbdocright") {
	if (location.search != "?toc=no") {
		var filename = location.pathname.replace(/\\/g, "/");
		filename = filename.substring(filename.lastIndexOf('/')+1);
		location.replace("index.html#" + filename);
	} 
}

function replaceTitleAndUrl(win, title, url) {
	if(history.replaceState) {
		win.history.replaceState(null, title, url);
	} else {
		win.document.title = document.title;
		win.location.replace(url);
	}
}
//-->
	</script>	
</head>

<body style="direction: ltr;">
	<script type="text/javascript">
		try {
			if (location.search != "?toc=no") {
				parent.document.title = document.title;
				var filename = location.pathname.replace(/\\/g, "/");
				filename = filename.substring(filename.lastIndexOf('/')+1);
				if (window.parent.location.search == null || window.parent.location.search != "?" + filename) {
					if (window.parent.location.hash == null || window.parent.location.hash != "#" + filename) {
						replaceTitleAndUrl(window.parent, document.title, "index.html#" + filename);
					}
				}
			}
		} catch (ex) {}
	</script>
	<div id="topic">
<!--HEADER START-->
  <div id="header">
  	<div id="runningHeaderText">ACBVentas Reference</div>
  	<h1 class="title">BVENT_DocsVenta.EliminarDocumentoVenta (Método)</h1>
  	<div id="headerLinks">

	<a href="#seeAlsoSection">Vea también</a>

		</div>
		<hr />
	</div>
<!--HEADER END-->
    
		<div id="mainSection">
      <div id="mainBody">
        <p />
       
        eliminar documentos de venta de area de ventas



        <br /><strong>Ensamblado:</strong> ACBVentas (in ACBVentas.dll)











<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Sintaxis</a></span>
		<div><hr /></div>
	</div>

	<div id="syntaxSection" class="section">	
	
	
	<div id="syntaxCodeBlocks">
		<div class="codeSnippetContainer">		
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCornerActive">
				</div>
				<div class="codeSnippetTab csFirstTab csActiveTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csLastTab csNaTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCorner">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeVB">
					<pre xml:space="preserve" class="brush: vb">Public Function EliminarDocumentoVenta( _&nbsp;<br />   ByVal <i>x_docve_codigo</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>, _&nbsp;<br />   ByVal <i>x_pedid_codigo</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>, _&nbsp;<br />   ByVal <i>x_xdocpago</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">Boolean</a>, _&nbsp;<br />   ByVal <i>x_usuario</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a> _&nbsp;<br />) As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">Boolean</a></pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>
		
		<div class="codeSnippetContainer">
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCorner">
				</div>
				<div class="codeSnippetTab csFirstTab csNaTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csActiveTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csLastTab csNaTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCorner">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeCsharp">
					<pre xml:space="preserve" class="brush: csharp">public <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">bool</a> EliminarDocumentoVenta(&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> <i>x_docve_codigo</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> <i>x_pedid_codigo</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">bool</a> <i>x_xdocpago</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> <i>x_usuario</i>&nbsp;<br />)</pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>

		<div class="codeSnippetContainer">
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCorner">
				</div>
				<div class="codeSnippetTab csFirstTab csNaTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csActiveTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csLastTab csNaTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCorner">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeCpp">
					<pre xml:space="preserve" class="brush: cpp">public: &nbsp;<br /><a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">bool</a> EliminarDocumentoVenta(&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>^ <i>x_docve_codigo</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>^ <i>x_pedid_codigo</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">bool</a> <i>x_xdocpago</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>^ <i>x_usuario</i>&nbsp;<br />) </pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>
		
		<div class="codeSnippetContainer">
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCorner">
				</div>
				<div class="codeSnippetTab csFirstTab csNaTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csActiveTab csLastTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCornerActive">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeJScript">
					<pre xml:space="preserve" class="brush: js">public function EliminarDocumentoVenta(&nbsp;<br />    <i>x_docve_codigo</i> : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>,&nbsp;<br />    <i>x_pedid_codigo</i> : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>,&nbsp;<br />    <i>x_xdocpago</i> : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">boolean</a>,&nbsp;<br />    <i>x_usuario</i> : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>&nbsp;<br />) : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">boolean</a>;</pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>
		
	</div>


<h4 class="subHeading">
	Parámetros</h4><dl paramName="x_docve_codigo">
	<dt>
		<span class="parameter">
			x_docve_codigo
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> 
		</p>
		<p>
			codigo del documento de venta 
		</p>
	</dd>
</dl>
<dl paramName="x_pedid_codigo">
	<dt>
		<span class="parameter">
			x_pedid_codigo
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> 
		</p>
		<p>
			codigo del pedido/cotizacion 
		</p>
	</dd>
</dl>
<dl paramName="x_xdocpago">
	<dt>
		<span class="parameter">
			x_xdocpago
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">bool</a> 
		</p>
		<p>
			opcion para anular el pago, segun el tipo de pago, efectivo o deposito 
		</p>
	</dd>
</dl>
<dl paramName="x_usuario">
	<dt>
		<span class="parameter">
			x_usuario
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> 
		</p>
		<p>
			codigo de usuario 
		</p>
	</dd>
</dl>

<p />
<p />














	</div>
</div>





















<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Código fuente</a></span>
		<div><hr /></div>
	</div>

	<div id="sourceCodeSection" class="section">	
		<div class="codeSnippetContainer">		
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCornerActive">
				</div>
				<div class="codeSnippetTab csFirstTab csActiveTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csNaTab csLastTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCorner">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeVB">
					<pre xml:space="preserve" class="brush: vb">
Public Function EliminarDocumentoVenta(ByVal x_docve_codigo As String, ByVal x_pedid_codigo As String, x_xdocpago As Boolean, ByVal x_usuario As String) As Boolean
    Try
       '' Verificar Guias de Remision
       Dim _guias As New BDIST_GuiasRemision
       Dim _whereguia As New Hashtable
       _whereguia.Add(&quot;DOCVE_Codigo&quot;, New ACWhere(x_docve_codigo))
       _whereguia.Add(&quot;GUIAR_Estado&quot;, New ACWhere(Constantes.getEstado(Constantes.Estado.Anulado), ACWhere.TipoWhere.Diferente))
       If _guias.CargarTodos(_whereguia) Then
          Throw New Exception(&quot;El documento tienen Guias Generadas, primero debe anular las guias para proceder&quot;)
       End If
       '' Verificar Ordenes
       Dim _orden As New BDIST_Ordenes
       Dim _whereorden As New Hashtable
       _whereorden.Add(&quot;DOCVE_Codigo&quot;, New ACWhere(x_docve_codigo))
       _whereorden.Add(&quot;ORDEN_Estado&quot;, New ACWhere(Constantes.getEstado(Constantes.Estado.Anulado), ACWhere.TipoWhere.Diferente))
       If _orden.CargarTodos(_whereorden) Then
          Throw New Exception(&quot;El documento tiene ordenes, primero debe anular las ordenes para poder proceder&quot;)
       End If
       '' Completar proceso de Eliminación
       DAEnterprise.BeginTransaction()
 
       '' verificar que no tenga pagos activos
       Dim _caja As New BTESO_Caja
       Dim _wherecaja As New Hashtable
       _wherecaja.Add(&quot;DOCVE_Codigo&quot;, New ACWhere(x_docve_codigo))
       If _caja.CargarTodos(_wherecaja) Then
 
       End If
 
       '' Romper la Relación de Guias de Remision
       If Not RomperRelacionDocsVentas(x_docve_codigo, m_pvent_id, x_xdocpago) Then
          Throw New Exception(&quot;No se puede completar la operación de romper relaciones con los documentos enlazados&quot;)
       End If
       '' Devolver el Stock Cargado si es una Cotización
       Dim _where As New Hashtable
       _where.Add(&quot;DOCVE_Codigo&quot;, New ACWhere(m_vent_docsventa.DOCVE_Codigo))
       Dim _pedidos As New BVENT_Pedidos()
       _pedidos.Cargar(x_pedid_codigo)
       If _pedidos.VENT_Pedidos.PEDID_Tipo = EVENT_Pedidos.TipoCotizacion(EVENT_Pedidos.TipoPedido.CT) Then
          '' Eliminar el detalle del documento de venta
          Dim _bventasdetalle As New BVENT_DocsVentaDetalle
          '' Eliminar Egreso de cada detalle
          If Cargar(x_docve_codigo, True) Then
             For Each Item As EVENT_DocsVentaDetalle In m_vent_docsventa.ListVENT_DocsVentaDetalle
                Dim m_bmanejarstocks As New BManejarStock()
                m_bmanejarstocks.EliminarEgresoFactura(m_periodo, Item.ARTIC_Codigo, Item.ALMAC_Id, _
                                                       m_vent_docsventa.DOCVE_Codigo, Item.DOCVD_Item, Item.DOCVD_Cantidad, x_usuario)
             Next
             ' Eliminar el Detalle del documento de Venta
             _bventasdetalle.Eliminar(_where)
          End If
       Else
          Dim _bventasdetalle As New BVENT_DocsVentaDetalle
          If Cargar(x_docve_codigo, True) Then
             For Each Item As EVENT_DocsVentaDetalle In m_vent_docsventa.ListVENT_DocsVentaDetalle
                Dim m_bmanejarstocks As New BManejarStock()
                m_bmanejarstocks.EliminarEgresoFactura(m_periodo, Item.ARTIC_Codigo, Item.ALMAC_Id, _
                                                       m_vent_docsventa.DOCVE_Codigo, Item.DOCVD_Item, Item.DOCVD_Cantidad, x_usuario)
             Next
             ' Eliminar el Detalle del documento de Venta
             _bventasdetalle.Eliminar(_where)
          End If
       End If
 
       '' Eliminar cabecera del Documento de venta
       Dim _bventas As New BVENT_DocsVenta
       If _bventas.Eliminar(_where) Then
          '' Verificar si hay Cotización - activar Cotización-Pedido
          If m_vent_docsventa.PEDID_Codigo.Length &gt; 0 Then
             '' Actualizar Estado de la Cotización
             Dim _bvent_pedidos As New BVENT_Pedidos()
             _bvent_pedidos.VENT_Pedidos = New EVENT_Pedidos
             _bvent_pedidos.VENT_Pedidos.PEDID_Estado = EVENT_Pedidos.getEstado(EVENT_Pedidos.Estado.Ingresado)
             _bvent_pedidos.VENT_Pedidos.PEDID_Codigo = x_pedid_codigo
             _bvent_pedidos.VENT_Pedidos.PEDID_DocumentoPercepcion = _pedidos.VENT_Pedidos.PEDID_DocumentoPercepcion
             _bvent_pedidos.VENT_Pedidos.PEDID_ParaFacturar = True
             _bvent_pedidos.VENT_Pedidos.Instanciar(ACEInstancia.Modificado)
             '' Actualizar el Pedido
             If _bvent_pedidos.Guardar(x_usuario) Then
                DAEnterprise.CommitTransaction()
                Return True
             Else
                DAEnterprise.RollBackTransaction()
                Return False
             End If
          End If
          '' Culminar Proceso
          DAEnterprise.CommitTransaction()
          Return True
       Else
          Throw New Exception(&quot;No se puede completar la operación de eliminar registro&quot;)
       End If
    Catch ex As Exception
       DAEnterprise.RollBackTransaction()
       Throw ex
    End Try
 End Function
					</pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>

	</div>					
</div>



<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Plataformas</a></span>
		<div><hr /></div>
	</div>

	<div id="platformsSection" class="section">	
		<p>
			Windows 8, Windows Server 2012, Windows 7, Windows Vista SP1 or later, Windows XP SP3, Windows XP SP2 x64 Edition, Windows Server 2008 (Server Core not supported), Windows Server 2008 R2 (Server Core supported with SP1 or later), Windows Server 2003 SP2
		</p>
		<p>
			.NET Framework no admite todas las versiones de cada plataforma. Para obtener una lista de las versiones admitidas, vea 
			<a target="_top" href="http://msdn2.microsoft.com/en-us/library/298275e2-da1d-4618-9f74-6a3567832350.aspx">System Requirements</a>.
		</p>
	</div>					
</div>



  

	

	
	

<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Información de versión</a></span>
		<div><hr /></div>
	</div>

	<div id="frameworksSection" class="section">	
  <h4 class="subHeading">.NET Framework</h4>Supported in: 4.5, 4, 3.5, 3.0, 2.0, 1.1, 1.0<br />

	<h4 class="subHeading">.NET Compact Framework</h4>Supported in: 3.5, 2.0, 1.0<br />

	<h4 class="subHeading">XNA Framework</h4>Supported in: 3.0, 2.0, 1.0<br />
	
	</div>					
</div>

<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Vea también</a></span>
		<div><hr /></div>
	</div>

	<div id="seeAlsoSection" class="section">	
		<div>
			<h4 class="subHeading">
				Referencia</h4>
			<a href="topic_0000000000000070.html">BVENT_DocsVenta (Clase)</a><br />
<a href="topic_0000000000000070_members--.html">BVENT_DocsVenta (Miembros)</a><br />




			

		</div>
	</div>					
</div>
			</div>
			</div>
      <div id="footer">
      	<p><span style="color: #FF0000;">Generated with unregistered version of <a target="_top" href="http://www.helixoft.com/vsdocman/overview.html">VSdocman</a></span>&nbsp;<br />Your own footer text will only be shown in registered version.</p>
      </div>
    </div>
  	<script type="text/javascript">
<!--
	try {
		parent.frames["vbdocswitch"].expandLinkInToc(location.href);
	} catch (ex) {}
//-->
		</script>	
  </body>
</html>

