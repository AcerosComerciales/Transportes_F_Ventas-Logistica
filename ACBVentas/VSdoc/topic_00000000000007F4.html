<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="GENERATOR" content="VSdocman - documentation generator; http://www.helixoft.com" />
	<title>BAdminCaja.GrabarCaja (Método)</title>

	<link rel="stylesheet" type="text/css" href="msdn10_lightweight/msdn10_lightweight.css"></link>
	<script src="msdn10_lightweight/msdn10_lightweight.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shCore_helixoft.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushVb.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushCSharp.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushCpp.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushJScript.js" type="text/javascript"></script>
	<link href="SyntaxHighlighter/styles/shCore.css" rel="stylesheet" type="text/css" />
	<link href="SyntaxHighlighter/styles/shThemeMsdnLW.css" rel="stylesheet" type="text/css" />
	<script type="text/javascript">
		SyntaxHighlighter.all();
	</script>				

	<script type="text/javascript">
<!--
if (self.name != "vbdocright") {
	if (location.search != "?toc=no") {
		var filename = location.pathname.replace(/\\/g, "/");
		filename = filename.substring(filename.lastIndexOf('/')+1);
		location.replace("index.html#" + filename);
	} 
}

function replaceTitleAndUrl(win, title, url) {
	if(history.replaceState) {
		win.history.replaceState(null, title, url);
	} else {
		win.document.title = document.title;
		win.location.replace(url);
	}
}
//-->
	</script>	
</head>

<body style="direction: ltr;">
	<script type="text/javascript">
		try {
			if (location.search != "?toc=no") {
				parent.document.title = document.title;
				var filename = location.pathname.replace(/\\/g, "/");
				filename = filename.substring(filename.lastIndexOf('/')+1);
				if (window.parent.location.search == null || window.parent.location.search != "?" + filename) {
					if (window.parent.location.hash == null || window.parent.location.hash != "#" + filename) {
						replaceTitleAndUrl(window.parent, document.title, "index.html#" + filename);
					}
				}
			}
		} catch (ex) {}
	</script>
	<div id="topic">
<!--HEADER START-->
  <div id="header">
  	<div id="runningHeaderText">ACBVentas Reference</div>
  	<h1 class="title">BAdminCaja.GrabarCaja (Método)</h1>
  	<div id="headerLinks">

	<a href="#seeAlsoSection">Vea también</a>

		</div>
		<hr />
	</div>
<!--HEADER END-->
    
		<div id="mainSection">
      <div id="mainBody">
        <p />
       
        Graba el conjunto de registros de caja



        <br /><strong>Ensamblado:</strong> ACBVentas (in ACBVentas.dll)











<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Sintaxis</a></span>
		<div><hr /></div>
	</div>

	<div id="syntaxSection" class="section">	
	
	
	<div id="syntaxCodeBlocks">
		<div class="codeSnippetContainer">		
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCornerActive">
				</div>
				<div class="codeSnippetTab csFirstTab csActiveTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csLastTab csNaTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCorner">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeVB">
					<pre xml:space="preserve" class="brush: vb">Private Function GrabarCaja( _&nbsp;<br />   ByVal <i>x_usuario</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>, _&nbsp;<br />   ByVal <i>m_tipopago</i> As <strong>TipoDePago</strong>, _&nbsp;<br />   ByRef <i>x_caja_codigo</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>, _&nbsp;<br />   ByRef <i>x_entid_Codigo</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>, _&nbsp;<br />   ByRef <i>x_importe</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.decimal.aspx">Decimal</a>, _&nbsp;<br />   ByRef <i>x_tipo_moneda</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>, _&nbsp;<br />   ByVal <i>x_serie</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>, _&nbsp;<br />   ByVal <i>x_fecha</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.datetime.aspx">Date</a>, _&nbsp;<br />   ByVal <i>x_redondeo</i> As <a target="_top" href="topic_00000000000007D1.html" onclick="this.target='';return true;">TRedondeo</a>, _&nbsp;<br />   ByVal <i>x_tipocambio</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.decimal.aspx">Decimal</a> _&nbsp;<br />) As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">Boolean</a></pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>
		
		<div class="codeSnippetContainer">
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCorner">
				</div>
				<div class="codeSnippetTab csFirstTab csNaTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csActiveTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csLastTab csNaTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCorner">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeCsharp">
					<pre xml:space="preserve" class="brush: csharp">private <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">bool</a> GrabarCaja(&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> <i>x_usuario</i>,&nbsp;<br />   <strong>TipoDePago</strong> <i>m_tipopago</i>,&nbsp;<br />   ref <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> <i>x_caja_codigo</i>,&nbsp;<br />   ref <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> <i>x_entid_Codigo</i>,&nbsp;<br />   ref <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.decimal.aspx">decimal</a> <i>x_importe</i>,&nbsp;<br />   ref <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> <i>x_tipo_moneda</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> <i>x_serie</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.datetime.aspx">DateTime</a> <i>x_fecha</i>,&nbsp;<br />   <a target="_top" href="topic_00000000000007D1.html" onclick="this.target='';return true;">TRedondeo</a> <i>x_redondeo</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.decimal.aspx">decimal</a> <i>x_tipocambio</i>&nbsp;<br />)</pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>

		<div class="codeSnippetContainer">
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCorner">
				</div>
				<div class="codeSnippetTab csFirstTab csNaTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csActiveTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csLastTab csNaTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCorner">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeCpp">
					<pre xml:space="preserve" class="brush: cpp">private: &nbsp;<br /><a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">bool</a> GrabarCaja(&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>^ <i>x_usuario</i>,&nbsp;<br />   <strong>TipoDePago</strong> <i>m_tipopago</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>^&amp; <i>x_caja_codigo</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>^&amp; <i>x_entid_Codigo</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.decimal.aspx">Decimal</a>&amp; <i>x_importe</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>^&amp; <i>x_tipo_moneda</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>^ <i>x_serie</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.datetime.aspx">DateTime</a> <i>x_fecha</i>,&nbsp;<br />   <a target="_top" href="topic_00000000000007D1.html" onclick="this.target='';return true;">TRedondeo</a> <i>x_redondeo</i>,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.decimal.aspx">Decimal</a> <i>x_tipocambio</i>&nbsp;<br />) </pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>
		
		<div class="codeSnippetContainer">
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCorner">
				</div>
				<div class="codeSnippetTab csFirstTab csNaTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csActiveTab csLastTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCornerActive">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeJScript">
					<pre xml:space="preserve" class="brush: js">private function GrabarCaja(&nbsp;<br />    <i>x_usuario</i> : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>,&nbsp;<br />    <i>m_tipopago</i> : <strong>TipoDePago</strong>,&nbsp;<br />    <i>x_caja_codigo</i> : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>,&nbsp;<br />    <i>x_entid_Codigo</i> : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>,&nbsp;<br />    <i>x_importe</i> : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.decimal.aspx">decimal</a>,&nbsp;<br />    <i>x_tipo_moneda</i> : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>,&nbsp;<br />    <i>x_serie</i> : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>,&nbsp;<br />    <i>x_fecha</i> : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.datetime.aspx">DateTime</a>,&nbsp;<br />    <i>x_redondeo</i> : <a target="_top" href="topic_00000000000007D1.html" onclick="this.target='';return true;">TRedondeo</a>,&nbsp;<br />    <i>x_tipocambio</i> : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.decimal.aspx">decimal</a>&nbsp;<br />) : <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">boolean</a>;</pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>
		
	</div>


<h4 class="subHeading">
	Parámetros</h4><dl paramName="x_usuario">
	<dt>
		<span class="parameter">
			x_usuario
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> 
		</p>
		<p>
			DNI del usuario que realiza la operación 
		</p>
	</dd>
</dl>
<dl paramName="m_tipopago">
	<dt>
		<span class="parameter">
			m_tipopago
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <strong>TipoDePago</strong> 
		</p>
		<p>
			Tipo de pago 
		</p>
	</dd>
</dl>
<dl paramName="x_caja_codigo">
	<dt>
		<span class="parameter">
			x_caja_codigo
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> 
		</p>
		<p>
			Codigo de Caja 
		</p>
	</dd>
</dl>
<dl paramName="x_entid_Codigo">
	<dt>
		<span class="parameter">
			x_entid_Codigo
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> 
		</p>
		<p>
			Codigo de la entidad 
		</p>
	</dd>
</dl>
<dl paramName="x_importe">
	<dt>
		<span class="parameter">
			x_importe
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.decimal.aspx">decimal</a> 
		</p>
		<p>
			Importe pagado 
		</p>
	</dd>
</dl>
<dl paramName="x_tipo_moneda">
	<dt>
		<span class="parameter">
			x_tipo_moneda
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> 
		</p>
		<p>
			Moneda del importe pagadp 
		</p>
	</dd>
</dl>
<dl paramName="x_serie">
	<dt>
		<span class="parameter">
			x_serie
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> 
		</p>
		<p>
			Numero de serie para el registro 
		</p>
	</dd>
</dl>
<dl paramName="x_fecha">
	<dt>
		<span class="parameter">
			x_fecha
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.datetime.aspx">DateTime</a> 
		</p>
		<p>
			fecha de cancelación 
		</p>
	</dd>
</dl>
<dl paramName="x_redondeo">
	<dt>
		<span class="parameter">
			x_redondeo
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <a target="_top" href="topic_00000000000007D1.html" onclick="this.target='';return true;">TRedondeo</a> 
		</p>
		<p>
			Tipo de redondeo 
		</p>
	</dd>
</dl>
<dl paramName="x_tipocambio">
	<dt>
		<span class="parameter">
			x_tipocambio
		</span>
	</dt>
	<dd>
		<p>
			Tipo: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.decimal.aspx">decimal</a> 
		</p>
		<p>
			Tipo de cambio 
		</p>
	</dd>
</dl>

<p />
<p />

	<h4 class="subHeading">
		Valor devuelto</h4>
  devuelve un valor verdadero si se ejecuta la consulta correctamente













	</div>
</div>





















<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Código fuente</a></span>
		<div><hr /></div>
	</div>

	<div id="sourceCodeSection" class="section">	
		<div class="codeSnippetContainer">		
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCornerActive">
				</div>
				<div class="codeSnippetTab csFirstTab csActiveTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csNaTab csLastTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCorner">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeVB">
					<pre xml:space="preserve" class="brush: vb">
Private Function GrabarCaja(ByVal x_usuario As String, ByVal m_tipopago As ETipos.TipoDePago, _
                             ByRef x_caja_codigo As String, ByRef x_entid_Codigo As String, ByRef x_importe As Decimal, ByRef x_tipo_moneda As String, _
                             ByVal x_serie As String, ByVal x_fecha As DateTime, ByVal x_redondeo As TRedondeo, ByVal x_tipocambio As Decimal) As Boolean
    Try
       Dim _i As Integer = 1
       Dim _numero As Integer = getNroTransaccion(m_pvent_id, x_serie)
       x_caja_codigo = String.Format(&quot;{0:00}{1}{2:0000000}&quot;, m_pvent_id, x_serie, _numero)
       '' Valores para el Redondeo
       Dim _glosa As String = &quot;&quot;
       Dim _factura As Decimal
       Dim _diferencia As Decimal
       Dim _pagar As Decimal = 0
       Dim _pagardiferencia As Decimal = 0
       Dim _docCaja As New EVENT_DocsVenta
       '' Iterar sobre los documentos de venta
       For Each item As EVENT_DocsVenta In m_listVENT_PagosFacturas
          item.TESO_Caja.CAJA_Importe = item.ImportePagar
          item.TESO_Caja.CAJA_Fecha = x_fecha
          item.TESO_Caja.TIPOS_CodTipoOrigen = ETipos.getTipoOrigen(ETipos.OrigenCancelacion.CancelacionDocumentosVentas)
          item.TESO_Caja.CAJA_Serie = x_serie
          item.TESO_Caja.CAJA_Numero = _numero
          item.TESO_Caja.TIPOS_CodTransaccion = ETipos.getTipoDePago(m_tipopago)
          item.TESO_Caja.CAJA_Glosa = IIf(m_tipopago = ETipos.TipoDePago.Efectivo, ACEVentas.Constantes.getGlosaTipoDePago(ETipos.TipoDePago.Efectivo), _
                               ACEVentas.Constantes.getGlosaTipoDePago(m_tipopago)) &amp; &quot; - &quot; &amp; String.Format(&quot;{0} {1}-{2:00000000}&quot;, item.TIPOS_TipoDocumento, item.DOCVE_Serie, item.DOCVE_Numero)
          item.TESO_Caja.CAJA_Codigo = x_caja_codigo
          item.TESO_Caja.CAJA_OrdenDocumento = _i
 
          Select Case m_tipopago
             Case ETipos.TipoDePago.DepositoBancario
                item.TESO_Caja.BANCO_Id = m_listteso_docspagos(0).BANCO_Id
             Case ETipos.TipoDePago.Cheque
                item.TESO_Caja.CAJA_Importe = 0
                x_redondeo = TRedondeo.SinRedondeo
             Case Else
 
          End Select
          If Not GrabarCajaDocumento(item, x_entid_Codigo, x_tipocambio, x_usuario) Then
             Throw New Exception(&quot;No se puede completar el proceso de grabado en caja&quot;)
          End If
          _i += 1
 
          x_importe += item.TESO_Caja.CAJA_Importe
          x_tipo_moneda = item.TESO_Caja.TIPOS_CodMonedaPago
 
          '' Para el Redondeo
          _docCaja = item.Clone
          _factura += item.TESO_Caja.CAJA_Importe
          _pagardiferencia += item.TESO_Caja.CAJA_Importe
          _glosa &amp;= String.Format(&quot;{0}, &quot;, item.Documento)
       Next
 
       '' Verificar Redondeo
       If x_redondeo &lt;&gt; TRedondeo.SinRedondeo Then
          _pagar = 0
          For Each Pag As ETESO_DocsPagos In m_listteso_docspagos
             If x_tipo_moneda = ETipos.getTipo(ETipos.TipoMoneda.Soles) Then
                If Pag.TIPOS_CodTipoMoneda = ETipos.getTipo(ETipos.TipoMoneda.Soles) Then
                   _pagar += Pag.DPAGO_Importe
                Else
                   _pagar += Pag.DPAGO_Importe * x_tipocambio
                End If
             Else
                If Pag.TIPOS_CodTipoMoneda = ETipos.getTipo(ETipos.TipoMoneda.Soles) Then
                   _pagar += Pag.DPAGO_Importe
                Else
                   _pagar += Pag.DPAGO_Importe / x_tipocambio
                End If
             End If
 
 
          Next
          _diferencia = Math.Abs(_factura - _pagar)
          '' Aplicar Redondeo
          Select Case x_redondeo
             Case TRedondeo.PorExcesoPago
                _docCaja.TIPOS_CodTipoDocumento = ETipos.getTipoComprobante(ETipos.TipoComprobanteVenta.ReciboIngreso)
                GrabarCajaDocumento(_docCaja, ETipos.TipoDePago.ReciboEgresoRedondeo, x_caja_codigo, _diferencia, x_tipocambio, _glosa, x_usuario)
                _i += 1
             Case TRedondeo.PorFaltaPago
                _docCaja.TIPOS_CodTipoDocumento = ETipos.getTipoComprobante(ETipos.TipoComprobanteVenta.ReciboEgreso)
                GrabarCajaDocumento(_docCaja, ETipos.TipoDePago.ReciboIngresoRedondeo, x_caja_codigo, -_diferencia, x_tipocambio, _glosa, x_usuario)
                _i += 1
             Case Else
          End Select
       End If
    Catch ex As Exception
       Throw ex
    End Try
 End Function
					</pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">Este idioma no es compatible o no hay ningún ejemplo de código disponible.</pre>			
				</div>
			</div>
		</div>

	</div>					
</div>



<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Plataformas</a></span>
		<div><hr /></div>
	</div>

	<div id="platformsSection" class="section">	
		<p>
			Windows 8, Windows Server 2012, Windows 7, Windows Vista SP1 or later, Windows XP SP3, Windows XP SP2 x64 Edition, Windows Server 2008 (Server Core not supported), Windows Server 2008 R2 (Server Core supported with SP1 or later), Windows Server 2003 SP2
		</p>
		<p>
			.NET Framework no admite todas las versiones de cada plataforma. Para obtener una lista de las versiones admitidas, vea 
			<a target="_top" href="http://msdn2.microsoft.com/en-us/library/298275e2-da1d-4618-9f74-6a3567832350.aspx">System Requirements</a>.
		</p>
	</div>					
</div>



  

	

	
	

<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Información de versión</a></span>
		<div><hr /></div>
	</div>

	<div id="frameworksSection" class="section">	
  <h4 class="subHeading">.NET Framework</h4>Supported in: 4.5, 4, 3.5, 3.0, 2.0, 1.1, 1.0<br />

	<h4 class="subHeading">.NET Compact Framework</h4>Supported in: 3.5, 2.0, 1.0<br />

	<h4 class="subHeading">XNA Framework</h4>Supported in: 3.0, 2.0, 1.0<br />
	
	</div>					
</div>

<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Vea también</a></span>
		<div><hr /></div>
	</div>

	<div id="seeAlsoSection" class="section">	
		<div>
			<h4 class="subHeading">
				Referencia</h4>
			<a href="topic_00000000000007BE.html">BAdminCaja (Clase)</a><br />
<a href="topic_00000000000007BE_members--.html">BAdminCaja (Miembros)</a><br />




			

		</div>
	</div>					
</div>
			</div>
			</div>
      <div id="footer">
      	<p><span style="color: #FF0000;">Generated with unregistered version of <a target="_top" href="http://www.helixoft.com/vsdocman/overview.html">VSdocman</a></span>&nbsp;<br />Your own footer text will only be shown in registered version.</p>
      </div>
    </div>
  	<script type="text/javascript">
<!--
	try {
		parent.frames["vbdocswitch"].expandLinkInToc(location.href);
	} catch (ex) {}
//-->
		</script>	
  </body>
</html>

